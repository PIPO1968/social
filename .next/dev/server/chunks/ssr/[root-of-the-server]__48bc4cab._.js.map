{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/components/UserLink.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\n\r\ninterface UserLinkProps {\r\n    nick: string;\r\n    className?: string;\r\n}\r\n\r\nexport const UserLink: React.FC<UserLinkProps> = ({ nick, className }) => {\r\n    const [isPremium, setIsPremium] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const checkPremium = async () => {\r\n            if (nick) {\r\n                try {\r\n                    const response = await fetch(`/api/user/premium-status?nick=${encodeURIComponent(nick)}`);\r\n                    const data = await response.json();\r\n                    setIsPremium(data.isPremium || false);\r\n                } catch (error) {\r\n                    setIsPremium(false);\r\n                }\r\n            }\r\n        };\r\n\r\n        // Verificar inicialmente\r\n        checkPremium();\r\n    }, [nick]);\r\n\r\n    const normalized = (nick || \"\").trim().toLowerCase();\r\n    if (!nick || normalized === \"anonimo\" || normalized === \"an칩nimo\") {\r\n        return <span className={className || \"text-gray-500\"}>{nick || \"(sin nick)\"}</span>;\r\n    }\r\n\r\n    return (\r\n        <a\r\n            href={`/perfil/${encodeURIComponent(nick)}`}\r\n            className={className || \"text-blue-600 underline hover:text-blue-800\"}\r\n            title={`Ver perfil de ${nick}${isPremium ? ' (Usuario Premium)' : ''}`}\r\n        >\r\n            {nick}\r\n            {isPremium && (\r\n                <span className=\"ml-1 inline-flex items-center\">\r\n                    <span\r\n                        className=\"bg-gradient-to-r from-sky-100 to-blue-100 text-amber-900 text-xs px-2 py-1 rounded-full font-bold shadow-md border border-sky-300\"\r\n                        title=\"Usuario Premium\"\r\n                    >\r\n                        游녬\r\n                    </span>\r\n                </span>\r\n            )}\r\n        </a>\r\n    );\r\n};\r\n"],"names":[],"mappings":";;;;;AAAA;;;AAOO,MAAM,WAAoC,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE;IACjE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAE3C,IAAA,kNAAS,EAAC;QACN,MAAM,eAAe;YACjB,IAAI,MAAM;gBACN,IAAI;oBACA,MAAM,WAAW,MAAM,MAAM,CAAC,8BAA8B,EAAE,mBAAmB,OAAO;oBACxF,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,aAAa,KAAK,SAAS,IAAI;gBACnC,EAAE,OAAO,OAAO;oBACZ,aAAa;gBACjB;YACJ;QACJ;QAEA,yBAAyB;QACzB;IACJ,GAAG;QAAC;KAAK;IAET,MAAM,aAAa,CAAC,QAAQ,EAAE,EAAE,IAAI,GAAG,WAAW;IAClD,IAAI,CAAC,QAAQ,eAAe,aAAa,eAAe,WAAW;QAC/D,qBAAO,8OAAC;YAAK,WAAW,aAAa;sBAAkB,QAAQ;;;;;;IACnE;IAEA,qBACI,8OAAC;QACG,MAAM,CAAC,QAAQ,EAAE,mBAAmB,OAAO;QAC3C,WAAW,aAAa;QACxB,OAAO,CAAC,cAAc,EAAE,OAAO,YAAY,uBAAuB,IAAI;;YAErE;YACA,2BACG,8OAAC;gBAAK,WAAU;0BACZ,cAAA,8OAAC;oBACG,WAAU;oBACV,OAAM;8BACT;;;;;;;;;;;;;;;;;AAOrB","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/utils/renderNick.tsx"],"sourcesContent":["import React from \"react\";\r\nimport { UserLink } from \"@/components/UserLink\";\r\n\r\nexport function renderNick(nick: string, className?: string) {\r\n    return <UserLink nick={nick} className={className} />;\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;AAEO,SAAS,WAAW,IAAY,EAAE,SAAkB;IACvD,qBAAO,8OAAC,0IAAQ;QAAC,MAAM;QAAM,WAAW;;;;;;AAC5C","debugId":null}},
    {"offset": {"line": 96, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/data/trofeos-premium.json"],"sourcesContent":["[{\"id\":101,\"titulo\":\"Historiador Premium\",\"descripcion\":\"Al menos 35 historias creadas.\",\"imagen\":\"/premium1.jpg\",\"criterio\":\"historiasCreadas >= 35\",\"exclusivoPremium\":true,\"beneficio\":\"Badge especial de historiador\"},{\"id\":102,\"titulo\":\"Sabio Premium\",\"descripcion\":\"1200 respuestas acertadas en Aprende con Pipo.\",\"imagen\":\"/premium2.jpg\",\"criterio\":\"respuestasAcertadas >= 1200\",\"exclusivoPremium\":true,\"beneficio\":\"T칤tulo de Sabio en perfil\"},{\"id\":103,\"titulo\":\"Amigo Premium\",\"descripcion\":\"Conseguir 60 amigos.\",\"imagen\":\"/premium3.jpg\",\"criterio\":\"amigos >= 60\",\"exclusivoPremium\":true,\"beneficio\":\"Badge de amistad especial\"},{\"id\":104,\"titulo\":\"Esp칤ritu Navide침o Premium\",\"descripcion\":\"Escribe una historia sobre la navidad en el modo \\\"My Live\\\", durante los d칤as 20 de diciembre y 6 de enero.\",\"imagen\":\"/premium14.jpg\",\"criterio\":\"tieneHistoriaNavidad\",\"exclusivoPremium\":true,\"beneficio\":\"Badge de celebraci칩n especial\"},{\"id\":105,\"titulo\":\"Verano Dorado Premium\",\"descripcion\":\"Crea una historia en modo \\\"My Live\\\", durante los d칤as de verano (15 junio a 15 septiembre)\",\"imagen\":\"/premium5.jpg\",\"criterio\":\"tieneHistoriaVerano\",\"exclusivoPremium\":true,\"beneficio\":\"Efecto de verano en perfil\"},{\"id\":106,\"titulo\":\"Veterano Dorado\",\"descripcion\":\"6 meses consecutivos como usuario Premium\",\"imagen\":\"/premium6.jpg\",\"criterio\":\"mesesPremium >= 6\",\"exclusivoPremium\":true,\"beneficio\":\"Crown dorada permanente\"},{\"id\":107,\"titulo\":\"Dise침ador del Futuro\",\"descripcion\":\"Crear el futuro logo de StoryUp con herramientas como Paint, en una historia con el t칤tulo \\\"Logo StoryUp\\\"\",\"imagen\":\"/premium7.png\",\"criterio\":\"tieneLogoStoryUp\",\"exclusivoPremium\":true,\"beneficio\":\"Reconocimiento como dise침ador oficial\",\"otorgadoPorAdmin\":true},{\"id\":108,\"titulo\":\"Escritor Premium\",\"descripcion\":\"Crear 50+ historias.\",\"imagen\":\"/premium8.png\",\"criterio\":\"historiasCreadas >= 50\",\"exclusivoPremium\":true,\"beneficio\":\"Badge de escritor prol칤fico\"},{\"id\":109,\"titulo\":\"Competidor Premium\",\"descripcion\":\"Consigue al menos 30 trofeos\",\"imagen\":\"/premium9.jpg\",\"criterio\":\"totalTrofeos >= 30\",\"exclusivoPremium\":true,\"beneficio\":\"Destacado en rankings\"},{\"id\":110,\"titulo\":\"Cerebro de Oro\",\"descripcion\":\"2500+ respuestas acertadas en Aprende con Pipo.\",\"imagen\":\"/premium10.jpg\",\"criterio\":\"respuestasAcertadas >= 2500\",\"exclusivoPremium\":true,\"beneficio\":\"T칤tulo de genio acad칠mico\"},{\"id\":111,\"titulo\":\"Analista Premium\",\"descripcion\":\"Consigue un nivel 3 en todas las materias en \\\"Analisis por materias\\\" de Estad칤sticas premium Avanzadas.\",\"imagen\":\"/premium11.jpg\",\"criterio\":\"todasNivel3\",\"exclusivoPremium\":true,\"beneficio\":\"Badge de perfecci칩n acad칠mica\"},{\"id\":112,\"titulo\":\"Red Social Premium\",\"descripcion\":\"Conseguir 100+ amigos.\",\"imagen\":\"/premium12.jpg\",\"criterio\":\"amigos >= 100\",\"exclusivoPremium\":true,\"beneficio\":\"T칤tulo de influencer social Premium\"}]"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 96, "column": 2900}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/data/trofeosPremiumImport.ts"],"sourcesContent":["// Archivo para importar y transformar trofeos premium desde el JSON\r\nimport trofeosPremium from './trofeos-premium.json';\r\n\r\nexport const TROFEOS_PREMIUM = trofeosPremium.map(t => ({\r\n    src: t.imagen,\r\n    texto: t.titulo,\r\n    tipo: 'manual'\r\n}));\r\n"],"names":[],"mappings":"AAAA,oEAAoE;;;;;AACpE;;AAEO,MAAM,kBAAkB,oHAAc,CAAC,GAAG,CAAC,CAAA,IAAK,CAAC;QACpD,KAAK,EAAE,MAAM;QACb,OAAO,EAAE,MAAM;QACf,MAAM;IACV,CAAC","debugId":null}},
    {"offset": {"line": 134, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/app/perfil/page.tsx"],"sourcesContent":["\"use client\";\r\nimport React, { useState, useEffect, useMemo } from \"react\";\r\nimport { renderNick } from \"@/utils/renderNick\";\r\nimport { TROFEOS_PREMIUM } from \"@/data/trofeosPremiumImport\";\r\nimport { useTranslation } from \"@/utils/i18n\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { BUTTON_STYLES } from \"../../utils/styles\";\r\nimport { useUser } from \"@/contexts/UserContext\";\r\nimport { UserLink } from \"@/components/UserLink\";\r\n\r\ninterface Usuario {\r\n    nick: string;\r\n    nombre: string;\r\n    email: string;\r\n    centro: string;\r\n    curso: string;\r\n    tipo: string;\r\n    fechaInscripcion: string;\r\n    likes: number;\r\n    amigos: string[];\r\n    respuestasAcertadas: number;\r\n    competicionesSuperadas: number;\r\n    concursosGanados: number;\r\n    comentariosRecibidos: number;\r\n    historiasCreadas: number;\r\n    anosEnStoryUp: number;\r\n    trofeos: any[];\r\n};\r\n\r\nconst PerfilUsuario: React.FC = () => {\r\n    const router = useRouter();\r\n    const { user, setUser } = useUser();\r\n    // Funci칩n para asignar trofeos al usuario si su centro gan칩 premios este mes\r\n    const asignarTrofeosUsuario = async (usuario: any) => {\r\n        if (typeof window === \"undefined\") return;\r\n\r\n        const fechaActual = new Date();\r\n        const year = fechaActual.getFullYear();\r\n        const month = fechaActual.getMonth() + 1;\r\n\r\n        try {\r\n            const response = await fetch(`/api/premios/mensuales?year=${year}&month=${month}`);\r\n            const premios = await response.json();\r\n            const premioCentro = premios.find((p: any) => p.centro === usuario.centro);\r\n\r\n            if (premioCentro) {\r\n                let idTrofeo = 0;\r\n                switch (premioCentro.posicion) {\r\n                    case 1: idTrofeo = 25; break; // Campe칩n Mensual\r\n                    case 2: idTrofeo = 26; break; // Subcampe칩n Mensual\r\n                    case 3: idTrofeo = 27; break; // Tercer Lugar Mensual\r\n                    default:\r\n                        if (premioCentro.posicion <= 10) {\r\n                            idTrofeo = 28; // Top 10 Mensual\r\n                        } else {\r\n                            idTrofeo = 29; // Participante Activo\r\n                        }\r\n                        break;\r\n                }\r\n\r\n                if (idTrofeo > 0 && !usuario.trofeosDesbloqueados.includes(idTrofeo)) {\r\n                    const updated = {\r\n                        trofeosDesbloqueados: [...usuario.trofeosDesbloqueados, idTrofeo],\r\n                        trofeosBloqueados: usuario.trofeosBloqueados\r\n                    };\r\n                    await fetch('/api/trofeos/user-trofeos', {\r\n                        method: 'POST',\r\n                        headers: { 'Content-Type': 'application/json' },\r\n                        body: JSON.stringify({ nick: usuario.nick, ...updated })\r\n                    });\r\n                }\r\n            }\r\n        } catch (e) {\r\n            console.error('Error asignando trofeos:', e);\r\n        }\r\n    };\r\n\r\n    const [bullyingActivo, setBullyingActivo] = useState(false);\r\n    const [usuarioBullying, setUsuarioBullying] = useState(\"\");\r\n    const [palabraProhibida, setPalabraProhibida] = useState(\"\");\r\n    const [concursoTitulo, setConcursoTitulo] = useState(\"\");\r\n    const [concursoTexto, setConcursoTexto] = useState(\"\");\r\n    const [fechaInicio, setFechaInicio] = useState(\"\");\r\n    const [fechaFin, setFechaFin] = useState(\"\");\r\n    const [usuarioGanador, setUsuarioGanador] = useState(\"\");\r\n    const [concursoId, setConcursoId] = useState(1);\r\n    const [nombreArchivo, setNombreArchivo] = useState(\"\");\r\n    const [usuarios, setUsuarios] = useState<any[]>([]);\r\n    const [selectedUser, setSelectedUser] = useState(\"\");\r\n    const [chatInput, setChatInput] = useState(\"\");\r\n    const [chatMessages, setChatMessages] = useState<{ from: string, to: string, text: string, fecha?: string }[]>([]);\r\n    const [mensajeRecibido, setMensajeRecibido] = useState(false);\r\n    const [tieneMensajesSinLeer, setTieneMensajesSinLeer] = useState(false);\r\n    const [noticiaTitulo, setNoticiaTitulo] = useState(\"\");\r\n    const [noticiaTexto, setNoticiaTexto] = useState(\"\");\r\n    const [noticiaImagen, setNoticiaImagen] = useState<string>(\"\");\r\n    // Estado para el trofeo seleccionado por el admin\r\n    const [trofeoSeleccionado, setTrofeoSeleccionado] = useState(\"\");\r\n    // Estados para gestionar concursos finalizados\r\n    const [concursoSeleccionado, setConcursoSeleccionado] = useState(\"\");\r\n    const [ganadorSeleccionado, setGanadorSeleccionado] = useState(\"\");\r\n    const [selectedUserData, setSelectedUserData] = useState<any>(null);\r\n    // Estados para datos de base de datos\r\n    const [premiumData, setPremiumData] = useState<any>(null);\r\n    const [userTrofeos, setUserTrofeos] = useState<{ trofeosDesbloqueados: number[]; trofeosBloqueados: number[] }>({ trofeosDesbloqueados: [], trofeosBloqueados: [] });\r\n    const [displayedUserProfile, setDisplayedUserProfile] = useState<any>(null);\r\n    const [concursos, setConcursos] = useState<any[]>([]);\r\n    // Estados para preguntas\r\n    const [cursoSeleccionado, setCursoSeleccionado] = useState<string>(\"1primaria\");\r\n    const [asignaturaSeleccionada, setAsignaturaSeleccionada] = useState<string>(\"matematicas\");\r\n    const [pregunta, setPregunta] = useState<string>(\"\");\r\n    const [respuesta, setRespuesta] = useState<string>(\"\");\r\n    // Estados para solicitudes de amistad\r\n    const [pendingRequests, setPendingRequests] = useState<any[]>([]);\r\n\r\n    const { t } = useTranslation();\r\n\r\n\r\n    const displayedUser = useMemo(() => selectedUser ? (selectedUserData || { ...user, trofeosDesbloqueados: userTrofeos.trofeosDesbloqueados, trofeosBloqueados: userTrofeos.trofeosBloqueados }) : { ...user, trofeosDesbloqueados: userTrofeos.trofeosDesbloqueados, trofeosBloqueados: userTrofeos.trofeosBloqueados }, [selectedUser, selectedUserData, user, userTrofeos]);\r\n\r\n    // Inicializaci칩n y sincronizaci칩n de rankings\r\n    useEffect(() => {\r\n        // Obtener concursos\r\n        fetch('/api/concursos')\r\n            .then(response => response.json())\r\n            .then(concursos => {\r\n                setConcursos(concursos);\r\n                // Calcular el pr칩ximo ID basado en los concursos existentes\r\n                const maxNumero = concursos.length > 0 ? Math.max(...concursos.map(c => c.numero)) : 0;\r\n                setConcursoId(maxNumero + 1);\r\n            })\r\n            .catch(error => {\r\n                console.warn('No se pudo cargar la lista de concursos:', error);\r\n            });\r\n\r\n        // Obtener todos los usuarios registrados para el selector del chat\r\n        fetch('/api/users')\r\n            .then(response => response.json())\r\n            .then(users => {\r\n                if (Array.isArray(users)) {\r\n                    // Ordenar alfab칠ticamente por nick\r\n                    users.sort((a, b) => a.nick.localeCompare(b.nick, 'es', { sensitivity: 'base' }));\r\n                    setUsuarios(users);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                console.warn('No se pudo cargar la lista de usuarios:', error);\r\n            });\r\n    }, []);\r\n\r\n    // Manejo seguro de datos premium y trofeos\r\n    useEffect(() => {\r\n        if (user && user.nick) {\r\n            fetch('/api/premium/data?nick=' + user.nick)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    if (data && !data.error) {\r\n                        setPremiumData(data);\r\n                    } else {\r\n                        setPremiumData(null);\r\n                        console.warn('No hay datos premium para este usuario.');\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    setPremiumData(null);\r\n                    console.warn('No se pudo cargar datos premium:', error);\r\n                });\r\n\r\n            // Cargar datos del perfil del usuario para sincronizar trofeos\r\n            fetch('/api/user/profile?nick=' + user.nick)\r\n                .then(response => response.json())\r\n                .then(profileData => {\r\n                    if (profileData && profileData.user) {\r\n                        // Guardar los datos completos del perfil\r\n                        setDisplayedUserProfile(profileData.user);\r\n\r\n                        // Sincronizar trofeos autom치ticos con los datos completos del perfil\r\n                        fetch('/api/trofeos/user-trofeos?nick=' + user.nick)\r\n                            .then(response => response.json())\r\n                            .then(trofeosData => {\r\n                                if (trofeosData && !trofeosData.error) {\r\n                                    setUserTrofeos(trofeosData);\r\n                                    // Sincronizar trofeos autom치ticos\r\n                                    syncAutoTrofeos(profileData.user, trofeosData);\r\n                                } else {\r\n                                    setUserTrofeos({ trofeosDesbloqueados: [], trofeosBloqueados: [] });\r\n                                    // Sincronizar trofeos autom치ticos\r\n                                    syncAutoTrofeos(profileData.user, { trofeosDesbloqueados: [], trofeosBloqueados: [] });\r\n                                }\r\n                            })\r\n                            .catch(error => {\r\n                                setUserTrofeos({ trofeosDesbloqueados: [], trofeosBloqueados: [] });\r\n                                console.warn('No se pudo cargar trofeos:', error);\r\n                                // Sincronizar trofeos autom치ticos\r\n                                syncAutoTrofeos(profileData.user, { trofeosDesbloqueados: [], trofeosBloqueados: [] });\r\n                            });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    console.warn('No se pudo cargar datos del perfil:', error);\r\n                });\r\n\r\n            fetch('/api/friends?action=requests&nick=' + user.nick)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    if (data.requests) {\r\n                        setPendingRequests(data.requests);\r\n                    } else {\r\n                        setPendingRequests([]);\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    setPendingRequests([]);\r\n                    console.warn('No se pudo cargar solicitudes:', error);\r\n                });\r\n        }\r\n    }, [user]);\r\n\r\n    // Cargar mensajes del chat solo cuando cambia el usuario\r\n    useEffect(() => {\r\n        if (user && user.nick) {\r\n            fetch('/api/chat?nick=' + user.nick)\r\n                .then(response => response.json())\r\n                .then(messages => {\r\n                    setChatMessages(messages);\r\n                    // Comprobar si hay mensajes no le칤dos\r\n                    const lastRead = localStorage.getItem('lastReadMsg') || '';\r\n                    // Buscar el 칰ltimo mensaje recibido para este usuario\r\n                    const lastReceived = messages.filter(msg => msg.to === user.nick)\r\n                        .map(msg => {\r\n                            // Parsear fecha robustamente\r\n                            const d = msg.fecha ? Date.parse(msg.fecha) : NaN;\r\n                            return isNaN(d) ? 0 : d;\r\n                        })\r\n                        .reduce((max, curr) => Math.max(max, curr), 0);\r\n                    const unread = lastReceived > Number(lastRead);\r\n                    setTieneMensajesSinLeer(unread);\r\n                })\r\n                .catch(error => {\r\n                    console.warn('No se pudo cargar los mensajes del chat:', error);\r\n                });\r\n        }\r\n    }, [user]);\r\n\r\n    const handlePalabraProhibidaSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setPalabraProhibida(\"\");\r\n    };\r\n    const handleSendMessage = () => {\r\n        if (!chatInput.trim() || !user || !selectedUser) return;\r\n        fetch('/api/chat', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ from: user.nick, to: selectedUser, text: chatInput.trim() })\r\n        })\r\n            .then(() => {\r\n                setChatInput('');\r\n                // Refrescar mensajes\r\n                fetch('/api/chat?nick=' + user.nick)\r\n                    .then(response => response.json())\r\n                    .then(messages => {\r\n                        setChatMessages(messages);\r\n                        // Guardar timestamp del 칰ltimo mensaje recibido como le칤do\r\n                        const lastReceived = messages.filter(msg => msg.to === user.nick)\r\n                            .map(msg => {\r\n                                const d = msg.fecha ? Date.parse(msg.fecha) : NaN;\r\n                                return isNaN(d) ? 0 : d;\r\n                            })\r\n                            .reduce((max, curr) => Math.max(max, curr), 0);\r\n                        if (lastReceived > 0) {\r\n                            localStorage.setItem('lastReadMsg', lastReceived.toString());\r\n                        } else {\r\n                            localStorage.setItem('lastReadMsg', Date.now().toString());\r\n                        }\r\n                        setTieneMensajesSinLeer(false);\r\n                    })\r\n                    .catch(error => console.warn('No se pudo refrescar los mensajes:', error));\r\n            })\r\n            .catch(error => {\r\n                console.error('Error enviando mensaje:', error);\r\n            });\r\n    };\r\n\r\n    const handleAcceptRequest = async (requestId: number) => {\r\n        if (!user) return;\r\n\r\n        try {\r\n            const response = await fetch('/api/friends', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ action: 'accept', userNick: user.nick, requestId })\r\n            });\r\n            if (response.ok) {\r\n                // Remover de pendingRequests\r\n                setPendingRequests(prev => prev.filter(r => r.id !== requestId));\r\n                // Recargar para actualizar contadores\r\n                window.location.reload();\r\n            } else {\r\n                alert('Error al aceptar solicitud');\r\n            }\r\n        } catch (error) {\r\n            alert('Error al aceptar solicitud');\r\n        }\r\n    };\r\n\r\n    const handleRejectRequest = async (requestId: number) => {\r\n        if (!user) return;\r\n\r\n        try {\r\n            const response = await fetch('/api/friends', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ action: 'reject', userNick: user.nick, requestId })\r\n            });\r\n            if (response.ok) {\r\n                // Remover de pendingRequests\r\n                setPendingRequests(prev => prev.filter(r => r.id !== requestId));\r\n                // Recargar para actualizar contadores\r\n                window.location.reload();\r\n            } else {\r\n                alert('Error al rechazar solicitud');\r\n            }\r\n        } catch (error) {\r\n            alert('Error al rechazar solicitud');\r\n        }\r\n    };\r\n    const handleApagarBullying = () => {\r\n        setBullyingActivo(false);\r\n        setUsuarioBullying(\"\");\r\n    };\r\n    const handleConcursoSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!concursoTitulo.trim() || !concursoTexto.trim() || !fechaInicio || !fechaFin) {\r\n            alert('Por favor, completa todos los campos: t칤tulo, descripci칩n, fecha de inicio y fecha de finalizaci칩n.');\r\n            return;\r\n        }\r\n        if (!user || !user.nick) {\r\n            alert('Debes estar logueado para crear un concurso.');\r\n            return;\r\n        }\r\n        fetch('/api/concursos', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n                numero: concursoId,\r\n                titulo: concursoTitulo,\r\n                texto: concursoTexto,\r\n                inicio: fechaInicio,\r\n                fin: fechaFin,\r\n                autor: user.nick,\r\n                ganador: usuarioGanador,\r\n                fechaFinal: fechaFin\r\n            })\r\n        })\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    return response.json().then(err => { throw new Error(err.error || 'Error desconocido'); });\r\n                }\r\n                return response.json();\r\n            })\r\n            .then(data => {\r\n                setConcursoId(concursoId + 1);\r\n                setConcursoTitulo(\"\");\r\n                setConcursoTexto(\"\");\r\n                setFechaInicio(\"\");\r\n                setFechaFin(\"\");\r\n                setUsuarioGanador(\"\");\r\n                // Refrescar concursos\r\n                fetch('/api/concursos').then(r => r.json()).then(setConcursos);\r\n                alert('Concurso creado exitosamente.');\r\n            })\r\n            .catch(error => {\r\n                console.error('Error creando concurso:', error);\r\n                alert('Error creando concurso: ' + error.message);\r\n            });\r\n    };\r\n    // Funci칩n general para sumar o restar likes a cualquier usuario\r\n    const updateLikes = (nick: string, cantidad: number) => {\r\n        if (!nick) return;\r\n        const currentLikes = usuarios.find((u: any) => u.nick === nick)?.likes || 0;\r\n        fetch('/api/users/update', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ nick, likes: currentLikes + cantidad })\r\n        })\r\n            .then(response => response.json())\r\n            .then(updatedUser => {\r\n                const updatedUsers = usuarios.map((u: any) => u.nick === nick ? updatedUser : u);\r\n                setUsuarios(updatedUsers);\r\n                if (user && user.nick === nick) {\r\n                    setUser(updatedUser);\r\n                }\r\n            })\r\n            .catch(error => console.error('Error updating likes:', error));\r\n    };\r\n\r\n    const handleSeleccionarGanador = () => {\r\n        if (usuarioGanador) {\r\n            fetch('/api/concursos', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ id: concursos[0].id, ganador: usuarioGanador })\r\n            })\r\n                .then(() => {\r\n                    updateLikes(usuarioGanador, 1);\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error seleccionando ganador:', error);\r\n                });\r\n        }\r\n    };\r\n    const handleAsignarGanador = async () => {\r\n        if (!concursoSeleccionado || !ganadorSeleccionado) {\r\n            return;\r\n        }\r\n        try {\r\n            await fetch('/api/concursos', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ id: concursoSeleccionado, ganador: ganadorSeleccionado })\r\n            });\r\n            updateLikes(ganadorSeleccionado, 10);\r\n            setConcursoSeleccionado(\"\");\r\n            setGanadorSeleccionado(\"\");\r\n            // Refrescar concursos\r\n            fetch('/api/concursos').then(r => r.json()).then(setConcursos);\r\n        } catch (error) {\r\n            console.error('Error asignando ganador:', error);\r\n        }\r\n    };\r\n    const handleNoticiaSubmit = (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        fetch('/api/noticias', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({\r\n                titulo: noticiaTitulo,\r\n                contenido: noticiaTexto,\r\n                autorNick: user ? user.nick : \"\"\r\n            })\r\n        })\r\n            .then(response => response.json())\r\n            .then(() => {\r\n                setNoticiaTitulo(\"\");\r\n                setNoticiaTexto(\"\");\r\n                setNoticiaImagen(\"\");\r\n            })\r\n            .catch(error => {\r\n                console.error('Error creando noticia:', error);\r\n            });\r\n    };\r\n\r\n    // Funci칩n para enviar pregunta\r\n    const enviarPregunta = async () => {\r\n        if (!pregunta.trim() || !respuesta.trim()) {\r\n            return;\r\n        }\r\n        try {\r\n            const response = await fetch('/api/add-question', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    curso: cursoSeleccionado,\r\n                    asignatura: asignaturaSeleccionada,\r\n                    pregunta: pregunta.trim(),\r\n                    respuesta: respuesta.trim(),\r\n                }),\r\n            });\r\n            const data = await response.json();\r\n            if (response.ok) {\r\n                setPregunta(\"\");\r\n                setRespuesta(\"\");\r\n            }\r\n        } catch (error) {\r\n            console.error('Error al enviar pregunta:', error);\r\n        }\r\n        // Funci칩n general para sumar o restar likes a cualquier usuario\r\n        const updateLikes = (nick: string, cantidad: number) => {\r\n            if (!nick) return;\r\n            const currentLikes = usuarios.find((u: any) => u.nick === nick)?.likes || 0;\r\n            fetch('/api/users/update', {\r\n                method: 'POST',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify({ nick, likes: currentLikes + cantidad })\r\n            })\r\n                .then(response => response.json())\r\n                .then(updatedUser => {\r\n                    const updatedUsers = usuarios.map((u: any) => u.nick === nick ? updatedUser : u);\r\n                    setUsuarios(updatedUsers);\r\n                    if (user && user.nick === nick) {\r\n                        setUser(updatedUser);\r\n                    }\r\n                })\r\n                .catch(error => console.error('Error updating likes:', error));\r\n        };\r\n    };\r\n    // Funci칩n para bloquear trofeo espec칤fico\r\n    const handleLockTrofeo = (trofeoIdx: number) => {\r\n        if (!selectedUser) return;\r\n        const updated = {\r\n            trofeosDesbloqueados: Array.isArray(userTrofeos.trofeosDesbloqueados) ? userTrofeos.trofeosDesbloqueados.filter((id: number) => id !== trofeoIdx) : [],\r\n            trofeosBloqueados: Array.isArray(userTrofeos.trofeosBloqueados) ? [...userTrofeos.trofeosBloqueados, trofeoIdx] : [trofeoIdx]\r\n        };\r\n        fetch('/api/trofeos/user-trofeos', {\r\n            method: 'POST',\r\n            headers: { 'Content-Type': 'application/json' },\r\n            body: JSON.stringify({ nick: selectedUser, ...updated })\r\n        })\r\n            .then(() => {\r\n                setUserTrofeos(updated);\r\n            })\r\n            .catch(error => {\r\n                console.error('Error locking trofeo:', error);\r\n            });\r\n    };    // Lista de trofeos normales (24)\r\n    const TROFEOS = [\r\n        { src: \"/trofeo25.jpg\", texto: \"Trofeo 1\", tipo: \"auto\" },\r\n        { src: \"/trofeo7.jpg\", texto: \"Trofeo 2\", tipo: \"auto\" },\r\n        { src: \"/trofeo12.jpg\", texto: \"Trofeo 3\", tipo: \"auto\" },\r\n        { src: \"/trofeo5.jpg\", texto: \"Trofeo 4\", tipo: \"auto\" },\r\n        { src: \"/trofeo13.png\", texto: \"Trofeo 5\", tipo: \"auto\" },\r\n        { src: \"/trofeo17.jpg\", texto: \"Trofeo 6\", tipo: \"auto\" },\r\n        { src: \"/trofeo27.jpg\", texto: \"Trofeo 7\", tipo: \"auto\" },\r\n        { src: \"/trofeo10.jpg\", texto: \"Trofeo 8\", tipo: \"auto\" },\r\n        { src: \"/trofeo23.jpg\", texto: \"Trofeo 9\", tipo: \"auto\" },\r\n        { src: \"/trofeo15.jpg\", texto: \"Trofeo 10\", tipo: \"auto\" },\r\n        { src: \"/trofeo26.jpg\", texto: \"Trofeo 11\", tipo: \"auto\" },\r\n        { src: \"/trofeo1.jpg\", texto: \"Trofeo 12\", tipo: \"auto\" },\r\n        { src: \"/trofeo22.jpg\", texto: \"Trofeo 13\", tipo: \"auto\" },\r\n        { src: \"/trofeo14.jpg\", texto: \"Trofeo 14\", tipo: \"auto\" },\r\n        { src: \"/trofeo20.jpg\", texto: \"Trofeo 15\", tipo: \"auto\" },\r\n        { src: \"/trofeo11.jpg\", texto: \"Trofeo 16\", tipo: \"auto\" },\r\n        { src: \"/trofeo24.jpg\", texto: \"Trofeo 17\", tipo: \"auto\" },\r\n        { src: \"/trofeo18.jpg\", texto: \"Trofeo 18\", tipo: \"auto\" },\r\n        { src: \"/trofeo19.jpg\", texto: \"Trofeo 19\", tipo: \"auto\" },\r\n        { src: \"/trofeo15.jpg\", texto: \"Trofeo 20\", tipo: \"auto\" },\r\n        { src: \"/trofeo9.jpg\", texto: \"Trofeo 21\", tipo: \"auto\" },\r\n        { src: \"/trofeo8.jpg\", texto: \"Trofeo 22\", tipo: \"auto\" },\r\n        { src: \"/trofeo21.jpg\", texto: \"Trofeo 23\", tipo: \"auto\" },\r\n        { src: \"/trofeo16.jpg\", texto: \"Trofeo 24\", tipo: \"auto\" },\r\n        { src: \"/trofeo1.jpg\", texto: \"游끥 Campe칩n Mensual\", tipo: \"asignado\" },\r\n        { src: \"/trofeo2.jpg\", texto: \"游볟 Subcampe칩n Mensual\", tipo: \"asignado\" },\r\n        { src: \"/trofeo3.jpg\", texto: \"游볠 Tercer Lugar Mensual\", tipo: \"asignado\" },\r\n        { src: \"/trofeo4.jpg\", texto: \"游끤 Top 10 Mensual\", tipo: \"asignado\" },\r\n        { src: \"/trofeo5.jpg\", texto: \"游닄 Participante Activo\", tipo: \"asignado\" }\r\n    ];\r\n    // Lista de trofeos premium (12)\r\n    // TROFEOS_PREMIUM ahora se importa desde trofeosPremiumImport.ts\r\n    // Trofeos autom치ticos con condici칩n\r\n    const TROFEOS_AUTO = [\r\n        { src: \"/trofeo25.jpg\", texto: \"Trofeo 1\", tipo: \"auto\", condicion: (user: any) => (user.likes || 0) >= 10 },\r\n        { src: \"/trofeo7.jpg\", texto: \"Trofeo 2\", tipo: \"auto\", condicion: (user: any) => Array.isArray(user.amigos) && user.amigos.length >= 1 },\r\n        { src: \"/trofeo12.jpg\", texto: \"Trofeo 3\", tipo: \"auto\", condicion: (user: any) => (user.comentariosRecibidos || 0) >= 1 },\r\n        { src: \"/trofeo5.jpg\", texto: \"Trofeo 4\", tipo: \"auto\", condicion: (user: any) => (user.historiasCreadas || 0) >= 1 },\r\n        { src: \"/trofeo13.png\", texto: \"Trofeo 5\", tipo: \"auto\", condicion: (user: any) => (user.respuestasAcertadas || 0) >= 20 },\r\n        { src: \"/trofeo17.jpg\", texto: \"Trofeo 6\", tipo: \"auto\", condicion: (user: any) => (user.competicionesSuperadas || 0) >= 1 },\r\n        {\r\n            src: \"/trofeo27.jpg\", texto: \"Trofeo 7\", tipo: \"auto\", condicion: (user: any) => {\r\n                // Aparecer en rankings\r\n                return (user.respuestasAcertadas || 0) >= 1 || (user.likes || 0) >= 1 || (user.historiasCreadas || 0) >= 1;\r\n            }\r\n        },\r\n        { src: \"/trofeo10.jpg\", texto: \"Trofeo 8\", tipo: \"auto\", condicion: (user: any) => (user.concursosGanados || 0) >= 1 },\r\n        { src: \"/trofeo23.jpg\", texto: \"Trofeo 9\", tipo: \"auto\", condicion: (user: any) => (user.likes || 0) >= 100 },\r\n        { src: \"/trofeo15.jpg\", texto: \"Trofeo 10\", tipo: \"auto\", condicion: (user: any) => Array.isArray(user.amigos) && user.amigos.length >= 10 },\r\n        { src: \"/trofeo26.jpg\", texto: \"Trofeo 11\", tipo: \"auto\", condicion: (user: any) => (user.historiasCreadas || 0) >= 3 },\r\n        { src: \"/trofeo1.jpg\", texto: \"Trofeo 12\", tipo: \"auto\", condicion: (user: any) => (user.comentariosRecibidos || 0) >= 3 },\r\n        { src: \"/trofeo22.jpg\", texto: \"Trofeo 13\", tipo: \"auto\", condicion: (user: any) => (user.competicionesSuperadas || 0) >= 1 },\r\n        { src: \"/trofeo14.jpg\", texto: \"Trofeo 14\", tipo: \"auto\", condicion: (user: any) => (user.likes || 0) >= 500 },\r\n        { src: \"/trofeo20.jpg\", texto: \"Trofeo 15\", tipo: \"auto\", condicion: (user: any) => Array.isArray(user.amigos) && user.amigos.length >= 30 },\r\n        { src: \"/trofeo11.jpg\", texto: \"Trofeo 16\", tipo: \"auto\", condicion: (user: any) => (user.comentariosRecibidos || 0) >= 10 },\r\n        { src: \"/trofeo24.jpg\", texto: \"Trofeo 17\", tipo: \"auto\", condicion: (user: any) => (user.historiasCreadas || 0) >= 15 },\r\n        { src: \"/trofeo18.jpg\", texto: \"Trofeo 18\", tipo: \"auto\", condicion: (user: any) => (user.concursosGanados || 0) >= 3 },\r\n        { src: \"/trofeo19.jpg\", texto: \"Trofeo 19\", tipo: \"auto\", condicion: (user: any) => (user.respuestasAcertadas || 0) >= 1000 },\r\n        { src: \"/trofeo15.jpg\", texto: \"Trofeo 20\", tipo: \"auto\", condicion: (user: any) => (user.anosEnStoryUp || 0) >= 1 },\r\n        { src: \"/trofeo9.jpg\", texto: \"Trofeo 21\", tipo: \"auto\", condicion: (user: any) => (user.historiasCreadas || 0) >= 30 },\r\n        { src: \"/trofeo8.jpg\", texto: \"Trofeo 22\", tipo: \"auto\", condicion: (user: any) => (user.likes || 0) >= 1000 },\r\n        { src: \"/trofeo21.jpg\", texto: \"Trofeo 23\", tipo: \"auto\", condicion: (user: any) => Array.isArray(user.amigos) && user.amigos.length >= 50 },\r\n        {\r\n            src: \"/trofeo16.jpg\", texto: \"Trofeo 24\", tipo: \"auto\", condicion: (user: any) => {\r\n                // M치ster (500 respuestas)\r\n                return (user.likes || 0) >= 500 && Array.isArray(user.amigos) && user.amigos.length >= 10 && (user.historiasCreadas || 0) >= 5 && (user.respuestasAcertadas || 0) >= 100;\r\n            }\r\n        }\r\n    ];\r\n    // Unificar todos los trofeos para el selector\r\n    const TROFEOS_ALL = [...TROFEOS, ...TROFEOS_PREMIUM];\r\n    // Funci칩n para obtener trofeos desbloqueados autom치ticamente\r\n    const getAutoTrofeos = (user: any) => {\r\n        // Trofeo Premium 7: Dise침ador del Futuro\r\n        // ...existing code...\r\n        // Asegurar que el campo amigos es siempre un array actualizado\r\n        const userSync = {\r\n            ...user,\r\n            amigos: Array.isArray(user.amigos) ? user.amigos : []\r\n        };\r\n\r\n        console.log('getAutoTrofeos: Evaluating user data:', userSync);\r\n\r\n        let autoTrofeos = TROFEOS_AUTO\r\n            .map((t, idx) => {\r\n                const conditionResult = typeof t.condicion === 'function' && t.condicion(userSync);\r\n                console.log(`getAutoTrofeos: Trofeo ${idx} condition result:`, conditionResult, 'for user data:', {\r\n                    likes: userSync.likes,\r\n                    amigos: userSync.amigos,\r\n                    comentariosRecibidos: userSync.comentariosRecibidos,\r\n                    historias: userSync.historias,\r\n                    respuestasAcertadas: userSync.respuestasAcertadas\r\n                });\r\n                return conditionResult ? idx + 1 : null;  // ids empiezan en 1\r\n            })\r\n            .filter(id => id !== null);\r\n\r\n        console.log('getAutoTrofeos: Final auto trofeos:', autoTrofeos);\r\n\r\n        // Desbloqueo autom치tico de trofeos premium\r\n        const esPremium = userSync.premium === true || userSync.isPremium === true || userSync.tipo === \"premium\";\r\n        const historiasCreadas = Array.isArray(userSync.historias) ? userSync.historias.length : (userSync.historiasCreadas || 0);\r\n        const respuestasAcertadas = userSync.respuestasAcertadas || 0;\r\n        // Trofeo Premium 1: Historiador Premium\r\n        if (esPremium && historiasCreadas >= 35) {\r\n            autoTrofeos.push(101); // id del trofeo premium 1\r\n        }\r\n        // Trofeo Premium 2: Sabio Premium\r\n        if (esPremium && respuestasAcertadas >= 1200) {\r\n            autoTrofeos.push(102); // id del trofeo premium 2\r\n        }\r\n        // Trofeo Premium 3: Amigo Premium\r\n        const amigosCount = Array.isArray(userSync.amigos) ? userSync.amigos.length : 0;\r\n        if (esPremium && amigosCount >= 60) {\r\n            autoTrofeos.push(103); // id del trofeo premium 3\r\n        }\r\n        // Trofeo Premium 4: Esp칤ritu Navide침o Premium\r\n        let tieneHistoriaNavidad = false;\r\n        if (esPremium && Array.isArray(userSync.historias)) {\r\n            tieneHistoriaNavidad = userSync.historias.some((historia: any) => {\r\n                if (!historia || !historia.titulo || !historia.fecha || !historia.modo) return false;\r\n                const tituloLower = historia.titulo.toLowerCase();\r\n                const esNavidad = tituloLower.includes(\"navidad\") || tituloLower.includes(\"navide침o\") || tituloLower.includes(\"navide침a\");\r\n                const fecha = new Date(historia.fecha);\r\n                const year = fecha.getFullYear();\r\n                // Rango: 20 diciembre a 6 enero (del a침o siguiente)\r\n                const inicio = new Date(year, 11, 20); // 20 diciembre\r\n                const fin = new Date(year + 1, 0, 6, 23, 59, 59); // 6 enero\r\n                return historia.modo === \"My Live\" && esNavidad && fecha >= inicio && fecha <= fin;\r\n            });\r\n        }\r\n        if (esPremium && tieneHistoriaNavidad) {\r\n            autoTrofeos.push(104); // id del trofeo premium 4\r\n        }\r\n        // Trofeo Premium 5: Verano Dorado Premium\r\n        let tieneHistoriaVerano = false;\r\n        if (esPremium && Array.isArray(userSync.historias)) {\r\n            tieneHistoriaVerano = userSync.historias.some((historia: any) => {\r\n                if (!historia || !historia.fecha || !historia.modo) return false;\r\n                const fecha = new Date(historia.fecha);\r\n                // Rango: 15 junio a 15 septiembre\r\n                const year = fecha.getFullYear();\r\n                const inicio = new Date(year, 5, 15); // 15 junio\r\n                const fin = new Date(year, 8, 15, 23, 59, 59); // 15 septiembre\r\n                return historia.modo === \"My Live\" && fecha >= inicio && fecha <= fin;\r\n            });\r\n        }\r\n        if (esPremium && tieneHistoriaVerano) {\r\n            autoTrofeos.push(105); // id del trofeo premium 5\r\n        }\r\n        // Trofeo Premium 6: Veterano Dorado\r\n        let mesesPremium = 0;\r\n        if (userSync.premiumInicio && userSync.premiumExpiracion) {\r\n            const inicio = new Date(userSync.premiumInicio);\r\n            const fin = new Date(userSync.premiumExpiracion);\r\n            // Calcular meses completos entre inicio y fin\r\n            mesesPremium = (fin.getFullYear() - inicio.getFullYear()) * 12 + (fin.getMonth() - inicio.getMonth());\r\n            // Si el d칤a de expiraci칩n es menor que el de inicio, restar un mes\r\n            if (fin.getDate() < inicio.getDate()) {\r\n                mesesPremium--;\r\n            }\r\n        }\r\n        if (esPremium && mesesPremium >= 6) {\r\n            autoTrofeos.push(106); // id del trofeo premium 6\r\n        }\r\n        // Trofeo Premium 7: Dise침ador del Futuro\r\n        let tieneLogoStoryUp = false;\r\n        if (esPremium && Array.isArray(userSync.historias)) {\r\n            tieneLogoStoryUp = userSync.historias.some((historia: any) => {\r\n                if (!historia || !historia.titulo || !historia.imagen) return false;\r\n                const tituloLower = historia.titulo.toLowerCase();\r\n                return tituloLower.includes(\"logo storyup\") && !!historia.imagen;\r\n            });\r\n        }\r\n        if (esPremium && tieneLogoStoryUp) {\r\n            autoTrofeos.push(107); // id del trofeo premium 7\r\n        }\r\n        // Trofeo Premium 8: Escritor Premium\r\n        if (esPremium && historiasCreadas >= 50) {\r\n            autoTrofeos.push(108); // id del trofeo premium 8\r\n        }\r\n\r\n        // Trofeo Premium 9: Competidor Premium\r\n        // Consigue al menos 30 trofeos (normales + premium)\r\n        const totalTrofeosDesbloqueados = Array.isArray(userSync.trofeosDesbloqueados) ? userSync.trofeosDesbloqueados.length : 0;\r\n        // Incluye los autom치ticos calculados en esta funci칩n\r\n        const totalAutoTrofeos = autoTrofeos.length;\r\n        const totalTrofeos = totalTrofeosDesbloqueados + totalAutoTrofeos;\r\n        if (esPremium && totalTrofeos >= 30) {\r\n            autoTrofeos.push(109); // id del trofeo premium 9\r\n        }\r\n        // Trofeo Premium 10: Cerebro de Oro\r\n        // 2500+ respuestas acertadas en Aprende con Pipo\r\n        if (esPremium && respuestasAcertadas >= 2500) {\r\n            autoTrofeos.push(110); // id del trofeo premium 10\r\n        }\r\n\r\n        // Trofeo Premium 11: Analista Premium\r\n        // Consigue nivel 3 en todas las materias en \"Analisis por materias\" de Estad칤sticas premium Avanzadas\r\n        // Suponemos que user.nivelesMaterias es un objeto tipo { matematicas: 3, lenguaje: 3, ... }\r\n        const materiasRequeridas = [\"matematicas\", \"lenguaje\", \"ciencias\", \"ingles\", \"historia\", \"geografia\", \"literatura\"];\r\n        const nivelesMaterias = userSync.nivelesMaterias || {};\r\n        const todasNivel3 = materiasRequeridas.every(m => nivelesMaterias[m] >= 3);\r\n        if (esPremium && todasNivel3) {\r\n            autoTrofeos.push(111); // id del trofeo premium 11\r\n        }\r\n        // Trofeo Premium 12: Red Social Premium\r\n        // Conseguir 100+ amigos\r\n        if (esPremium && amigosCount >= 100) {\r\n            autoTrofeos.push(112); // id del trofeo premium 12\r\n        }\r\n        return autoTrofeos;\r\n    };\r\n    // Funci칩n para sincronizar trofeos autom치ticos\r\n    const syncAutoTrofeos = async (userData: any, currentTrofeos: any) => {\r\n        if (!userData || !userData.nick) {\r\n            console.log('syncAutoTrofeos: No userData or nick', userData);\r\n            return;\r\n        }\r\n\r\n        console.log('syncAutoTrofeos: Starting for user', userData.nick, 'with data:', userData);\r\n        console.log('syncAutoTrofeos: Checking conditions manually:');\r\n        console.log('- amigos:', userData.amigos, '>= 1?', userData.amigos >= 1);\r\n        console.log('- likes:', userData.likes, '>= 10?', userData.likes >= 10);\r\n        console.log('- historias:', userData.historias, '>= 1?', userData.historias >= 1);\r\n        console.log('- respuestasAcertadas:', userData.respuestasAcertadas, '>= 20?', userData.respuestasAcertadas >= 20);\r\n        console.log('- comentariosRecibidos:', userData.comentariosRecibidos, '>= 1?', userData.comentariosRecibidos >= 1);\r\n\r\n        try {\r\n            // Calcular trofeos autom치ticos que deber칤an estar desbloqueados\r\n            const autoTrofeos = getAutoTrofeos(userData);\r\n            console.log('syncAutoTrofeos: Auto trofeos calculated:', autoTrofeos);\r\n\r\n            const manual = Array.isArray(currentTrofeos.trofeosDesbloqueados) ? currentTrofeos.trofeosDesbloqueados : [];\r\n            const bloqueados = Array.isArray(currentTrofeos.trofeosBloqueados) ? currentTrofeos.trofeosBloqueados : [];\r\n\r\n            console.log('syncAutoTrofeos: Current trofeos - manual:', manual, 'bloqueados:', bloqueados);\r\n\r\n            // Filtrar trofeos autom치ticos que no est치n ya desbloqueados ni bloqueados\r\n            const nuevosAutoTrofeos = autoTrofeos.filter((idx: number) =>\r\n                !manual.includes(idx) && !bloqueados.includes(idx)\r\n            );\r\n\r\n            // Trofeos que ya no cumplen la condici칩n (remover)\r\n            const toRemove = manual.filter((id: number) => !autoTrofeos.includes(id));\r\n\r\n            console.log('syncAutoTrofeos: Trofeos to remove:', toRemove);\r\n\r\n            let updatedTrofeosDesbloqueados = manual;\r\n\r\n            if (nuevosAutoTrofeos.length > 0 || toRemove.length > 0) {\r\n                // Agregar nuevos y remover los que ya no cumplen\r\n                updatedTrofeosDesbloqueados = [...manual, ...nuevosAutoTrofeos].filter(id => !toRemove.includes(id));\r\n\r\n                const updated = {\r\n                    trofeosDesbloqueados: updatedTrofeosDesbloqueados,\r\n                    trofeosBloqueados: bloqueados\r\n                };\r\n\r\n                console.log('syncAutoTrofeos: Saving updated trofeos:', updated);\r\n\r\n                // Guardar en la base de datos\r\n                await fetch('/api/trofeos/user-trofeos', {\r\n                    method: 'POST',\r\n                    headers: { 'Content-Type': 'application/json' },\r\n                    body: JSON.stringify({ nick: userData.nick, ...updated })\r\n                });\r\n\r\n                // Actualizar el estado local\r\n                setUserTrofeos(updated);\r\n\r\n                console.log(`Sincronizados ${nuevosAutoTrofeos.length} trofeos autom치ticos y removidos ${toRemove.length} trofeos para ${userData.nick}`);\r\n            } else {\r\n                console.log('syncAutoTrofeos: No changes needed');\r\n            }\r\n        } catch (error) {\r\n            console.error('Error sincronizando trofeos autom치ticos:', error);\r\n        }\r\n    };\r\n    // Funci칩n para saber si un trofeo est치 desbloqueado\r\n    const isTrofeoUnlocked = (user: any, idx: number) => {\r\n        console.log('isTrofeoUnlocked called with user:', user, 'idx:', idx);\r\n        console.log('displayedUser:', displayedUser);\r\n        console.log('userTrofeos:', userTrofeos);\r\n\r\n        // Calcular trofeos autom치ticos basados en los datos del usuario\r\n        const auto = getAutoTrofeos(user);\r\n        console.log('Auto trofeos for this user:', auto);\r\n\r\n        // Usar los trofeos guardados en la base de datos\r\n        const manual = Array.isArray(userTrofeos.trofeosDesbloqueados) ? userTrofeos.trofeosDesbloqueados : [];\r\n        const bloqueados = Array.isArray(userTrofeos.trofeosBloqueados) ? userTrofeos.trofeosBloqueados : [];\r\n\r\n        console.log('Manual trofeos:', manual, 'Bloqueados:', bloqueados);\r\n\r\n        // Mapear idx a trofeoId\r\n        const getTrofeoId = (idx: number) => {\r\n            if (idx < TROFEOS.length) {\r\n                return idx + 1;\r\n            } else {\r\n                return 101 + (idx - TROFEOS.length);\r\n            }\r\n        };\r\n\r\n        const trofeoId = getTrofeoId(idx);\r\n        const isUnlocked = (auto.includes(trofeoId) || manual.includes(trofeoId)) && !bloqueados.includes(trofeoId);\r\n        console.log('Trofeo', idx, 'id:', trofeoId, 'is unlocked:', isUnlocked);\r\n\r\n        return isUnlocked;\r\n    };\r\n\r\n    if (!user) {\r\n        return (\r\n            <div className=\"min-h-screen bg-green-100 flex items-center justify-center\">\r\n                <div className=\"max-w-md w-full bg-white shadow rounded p-6 text-center\">\r\n                    <h2 className=\"text-2xl font-bold mb-4\">Perfil</h2>\r\n                    <p className=\"text-gray-600\">No se ha iniciado sesi칩n.</p>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    const isPremium = displayedUser ? (displayedUser.premium === true || displayedUser.isPremium === true || displayedUser.tipo === \"premium\") : false;\r\n    return (\r\n        <div className=\"min-h-screen bg-green-100 flex flex-col pt-4\">\r\n            {/* Solicitudes de Amistad Pendientes */}\r\n            {pendingRequests.length > 0 && (\r\n                <div className=\"w-full max-w-4xl mx-auto mb-4\">\r\n                    <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n                        <h3 className=\"text-lg font-bold text-yellow-800 mb-2\">Solicitudes de Amistad Pendientes</h3>\r\n                        {pendingRequests.map((request: any) => (\r\n                            <div key={request.id} className=\"flex items-center justify-between bg-white p-3 rounded mb-2 shadow\">\r\n                                <span className=\"text-gray-700\">Solicitud de <strong>{renderNick(request.solicitante.nick)}</strong></span>\r\n                                <div className=\"flex gap-2\">\r\n                                    <button\r\n                                        onClick={() => handleAcceptRequest(request.id)}\r\n                                        className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded font-semibold\"\r\n                                    >\r\n                                        Aceptar\r\n                                    </button>\r\n                                    <button\r\n                                        onClick={() => handleRejectRequest(request.id)}\r\n                                        className=\"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded font-semibold\"\r\n                                    >\r\n                                        Rechazar\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                </div>\r\n            )}\r\n            <div className=\"w-full max-w-6xl mx-auto mt-4 mb-4 flex items-center justify-center gap-4\">\r\n                {tieneMensajesSinLeer && (\r\n                    <button\r\n                        className=\"bg-green-500 text-white px-4 py-2 rounded font-semibold animate-bounce\"\r\n                        onClick={() => {\r\n                            localStorage.setItem('lastReadMsg', Date.now().toString());\r\n                            setTieneMensajesSinLeer(false);\r\n                        }}\r\n                    >\r\n                        Mensajes sin leer\r\n                    </button>\r\n                )}\r\n                <h1 className=\"text-3xl font-bold text-center\">Perfil de: <UserLink nick={displayedUser.nick} /></h1>\r\n            </div>\r\n            <div className=\"w-full max-w-6xl mx-auto mt-8 grid grid-cols-2 gap-8\">\r\n                {/* Informaci칩n Personal - Izquierda */}\r\n                <div className={`bg-white rounded-lg shadow-md p-6 flex flex-col items-center relative transition-all duration-500 ${isPremium ? 'border-4 border-yellow-400 shadow-2xl shadow-yellow-400/50 animate-pulse overflow-hidden' : ''}`}>\r\n                    {/* Efecto de part칤culas para premium */}\r\n                    {isPremium && (\r\n                        <div className=\"absolute inset-0 pointer-events-none\">\r\n                            <div className=\"absolute top-2 right-2 w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75\"></div>\r\n                            <div className=\"absolute top-4 left-4 w-1 h-1 bg-yellow-300 rounded-full animate-bounce opacity-60\"></div>\r\n                            <div className=\"absolute bottom-4 right-6 w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse opacity-80\"></div>\r\n                        </div>\r\n                    )}\r\n\r\n                    <div className=\"flex justify-between items-center mb-4 relative\">\r\n                        <h3 className={`text-xl font-bold text-center w-full transition-all duration-300 ${isPremium ? 'text-yellow-600' : ''}`}>\r\n                            Informaci칩n Personal\r\n                            {isPremium && (\r\n                                <span className=\"ml-2 animate-spin\">游녬</span>\r\n                            )}\r\n                        </h3>\r\n                    </div>\r\n\r\n                    <div className=\"flex flex-col items-center mb-4 relative\">\r\n                        <div className={`relative ${isPremium ? '' : ''}`}>\r\n                            <img src={displayedUser.avatar || \"/avatars/simple1.png\"} alt=\"Avatar\" className={`w-20 h-20 rounded-full mb-2 transition-all duration-300 ${isPremium ? 'ring-4 ring-yellow-400 ring-opacity-70 shadow-lg shadow-yellow-400/50 hover:scale-110' : ''}`} />\r\n                            {isPremium && (\r\n                                <div className=\"absolute -top-1 -right-1 w-6 h-6 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-xs animate-bounce\">\r\n                                    九\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <div className=\"mt-4\">\r\n                            <a href=\"/perfil/avatar\" className=\"bg-blue-500 text-white px-4 py-2 rounded font-semibold hover:bg-blue-600 transition\">Seleccionar y Cambiar Avatar</a>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <p><strong>Nick:</strong> {renderNick(displayedUser.nick)}</p>\r\n                    <p><strong>Email:</strong> {displayedUser.email}</p>\r\n                    <p><strong>Centro Educativo:</strong> {displayedUser.centro}</p>\r\n                    <p><strong>Curso:</strong> {displayedUser.curso}</p>\r\n                    <p><strong>Tipo de Usuario:</strong> {displayedUser.tipo}</p>\r\n                    <p><strong>Fecha de Inscripci칩n:</strong> {displayedUser.fechaInscripcion ? new Date(displayedUser.fechaInscripcion).toLocaleDateString('es-ES') : ''}</p>\r\n                    <div className=\"mb-2 flex items-center\">\r\n                        <div className=\"flex flex-col mt-2 gap-y-4\">\r\n                            <div className=\"flex flex-row gap-x-12\">\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游녨</span>\r\n                                    <strong>Likes:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-green-300 text-green-900 font-bold text-sm\">{displayedUser.likes || 0}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center ml-8\">\r\n                                    <span className=\"mr-2 text-lg\">游논</span>\r\n                                    <strong>Total de Amigos:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-300 text-blue-900 font-bold text-sm\">{displayedUser.amigos || 0}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex flex-row gap-x-12\">\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游닀</span>\r\n                                    <strong>Total de Historias:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-purple-200 text-purple-900 font-bold text-sm\">{displayedUser.historias ? displayedUser.historias.length : 0}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游눫</span>\r\n                                    <strong>Total de Comentarios:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-yellow-200 text-yellow-900 font-bold text-sm\">{displayedUser.comentariosRecibidos || 0}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex flex-row gap-x-12\">\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游끥</span>\r\n                                    <strong>Trofeos Desbloqueados:</strong>\r\n                                    {(() => {\r\n                                        const trofeos = Array.isArray(displayedUser.trofeosDesbloqueados) ? displayedUser.trofeosDesbloqueados : [];\r\n                                        const total = trofeos.length;\r\n                                        return (\r\n                                            <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-pink-200 text-pink-900 font-bold text-sm\">{total}</span>\r\n                                        );\r\n                                    })()}\r\n                                </div>\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">九</span>\r\n                                    <strong>Respuestas acertadas:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-indigo-200 text-indigo-900 font-bold text-sm\">{displayedUser.respuestasAcertadas || 0}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex flex-row gap-x-12\">\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游볞</span>\r\n                                    <strong>Competiciones:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-teal-200 text-teal-900 font-bold text-sm\">{displayedUser.competicionesSuperadas || 0}</span>\r\n                                </div>\r\n                                <div className=\"flex items-center\">\r\n                                    <span className=\"mr-2 text-lg\">游꿀</span>\r\n                                    <strong>Concursos:</strong>\r\n                                    <span className=\"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-200 text-red-900 font-bold text-sm\">{displayedUser.concursosGanados || 0}</span>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Trofeos y Trofeos Premium - Derecha */}\r\n                <div className=\"flex flex-col gap-4\">\r\n                    {/* Trofeos */}\r\n                    <div className=\"bg-white shadow-lg rounded-lg p-6\">\r\n                        <h3 className=\"text-xl font-bold text-center mb-4\">Trofeos</h3>\r\n                        <div className=\"grid grid-cols-4 md:grid-cols-8 gap-4\">\r\n                            {TROFEOS.slice(0, 24).map((trofeo, idx) => (\r\n                                <div key={idx} className={`relative aspect-square flex flex-col items-center justify-center p-1 rounded-lg overflow-hidden ${isTrofeoUnlocked(displayedUser, idx) ? 'bg-yellow-100 border-2 border-yellow-400' : 'bg-gray-100 border-2 border-gray-300'}`}>\r\n                                    <img src={trofeo.src} alt={trofeo.texto} className={`w-[50px] h-[50px] ${!isTrofeoUnlocked(displayedUser, idx) ? 'opacity-25' : ''}`} />\r\n                                    {!isTrofeoUnlocked(displayedUser, idx) && (\r\n                                        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                            <span className=\"text-red-600 text-4xl font-bold\">九</span>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Trofeos Premium */}\r\n                    <div className=\"bg-white shadow-lg rounded-lg p-6\">\r\n                        <h3 className=\"text-xl font-bold text-center mb-4\">Trofeos Premium</h3>\r\n                        <div className=\"grid grid-cols-4 md:grid-cols-6 gap-4\">\r\n                            {TROFEOS_PREMIUM.map((trofeo, idx) => (\r\n                                <div key={idx} className={`relative aspect-square flex flex-col items-center justify-center p-1 rounded-lg overflow-hidden ${isTrofeoUnlocked(displayedUser, TROFEOS.length + idx) ? 'bg-purple-100 border-2 border-purple-400' : 'bg-gray-100 border-2 border-gray-300'}`}>\r\n                                    <img src={trofeo.src} alt={trofeo.texto} className={`w-[50px] h-[50px] ${!isTrofeoUnlocked(displayedUser, TROFEOS.length + idx) ? 'opacity-25' : ''}`} />\r\n                                    {!isTrofeoUnlocked(displayedUser, TROFEOS.length + idx) && (\r\n                                        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                                            <span className=\"text-red-600 text-4xl font-bold\">九</span>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            ))}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Chat - Debajo */}\r\n            <div className=\"w-full max-w-6xl mx-auto mt-8\">\r\n                <div className=\"bg-white shadow-lg rounded-lg p-6 flex flex-row gap-6\">\r\n                    {/* Selector de usuario a la izquierda */}\r\n                    <div className=\"w-1/4 min-w-[180px] flex flex-col gap-2\">\r\n                        <label htmlFor=\"user-selector\" className=\"font-semibold mb-2\">Selecciona usuario:</label>\r\n                        <select\r\n                            id=\"user-selector\"\r\n                            className=\"border rounded px-3 py-2\"\r\n                            value={selectedUser}\r\n                            onChange={e => setSelectedUser(e.target.value)}\r\n                        >\r\n                            <option value=\"\">-- Elige un usuario --</option>\r\n                            {usuarios.filter(u => u.nick !== user.nick).map(u => (\r\n                                <option key={u.nick} value={u.nick}>{u.nick}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                    {/* Chat principal */}\r\n                    <div className=\"flex-1 flex flex-col\">\r\n                        <h3 className=\"text-xl font-bold text-center mb-4\">Chat</h3>\r\n                        <div className=\"h-64 overflow-y-auto border rounded p-4 mb-4 bg-gray-50\">\r\n                            {chatMessages.slice(-5).map((msg, idx) => {\r\n                                const esEnviado = msg.from === user.nick;\r\n                                const tipo = esEnviado ? 'enviado' : 'recibido';\r\n                                const fecha = msg.fecha ? new Date(msg.fecha) : new Date();\r\n                                // Mostrar fecha robustamente\r\n                                let fechaStr = '';\r\n                                if (msg.fecha) {\r\n                                    const d = Date.parse(msg.fecha);\r\n                                    if (!isNaN(d)) {\r\n                                        const fecha = new Date(d);\r\n                                        fechaStr = `${fecha.toLocaleDateString('es-ES')} - ${fecha.toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' })}`;\r\n                                    } else {\r\n                                        fechaStr = msg.fecha;\r\n                                    }\r\n                                }\r\n                                else {\r\n                                    fechaStr = '';\r\n                                }\r\n                                return (\r\n                                    <div key={idx} className={`mb-2 ${esEnviado ? 'text-right' : 'text-left'}`}>\r\n                                        <span className=\"font-semibold\">{msg.from}:</span> {msg.text}\r\n                                        <span className=\"text-xs text-gray-500 ml-2\">({tipo} - {fechaStr})</span>\r\n                                    </div>\r\n                                );\r\n                            })}\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                            <input\r\n                                type=\"text\"\r\n                                value={chatInput}\r\n                                onChange={(e) => setChatInput(e.target.value)}\r\n                                placeholder=\"Escribe un mensaje...\"\r\n                                className=\"flex-1 border rounded px-3 py-2\"\r\n                                onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}\r\n                                disabled={!selectedUser}\r\n                            />\r\n                            <button\r\n                                onClick={handleSendMessage}\r\n                                className=\"bg-blue-500 text-white px-4 py-2 rounded font-semibold\"\r\n                                disabled={!selectedUser || !chatInput.trim()}\r\n                            >\r\n                                Enviar\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* BLOQUES EXTRA SOLO PARA DOCENTES */}\r\n            {user.tipo && user.tipo.toLowerCase() === \"docente\" && (\r\n                <>\r\n                    <div className=\"w-full max-w-6xl mx-auto mt-20\">\r\n                        <div className=\"grid grid-cols-2 gap-12\">\r\n                            <div className=\"bg-white shadow-lg rounded-lg p-6\">\r\n                                <h3 className=\"text-xl font-bold text-center mb-2\">Crear noticia</h3>\r\n                                <form className=\"w-full flex flex-col gap-4\" onSubmit={handleNoticiaSubmit}>\r\n                                    <input type=\"text\" className=\"border rounded px-3 py-2 w-full\" placeholder=\"T칤tulo de la noticia\" value={noticiaTitulo} onChange={e => setNoticiaTitulo(e.target.value)} />\r\n                                    <div className=\"relative w-full\">\r\n                                        <textarea className=\"border rounded px-3 py-2 w-full min-h-[80px]\" placeholder=\"Escribe la noticia aqu칤...\" value={noticiaTexto} onChange={e => setNoticiaTexto(e.target.value)} />\r\n                                        {noticiaImagen && (\r\n                                            <img src={noticiaImagen} alt=\"Previsualizaci칩n\" className=\"absolute left-0 top-0 w-full h-full object-contain rounded shadow pointer-events-none\" style={{ zIndex: 1, opacity: 0.7 }} />\r\n                                        )}\r\n                                    </div>\r\n                                    <div className=\"flex items-center gap-4 mt-2\">\r\n                                        <input id=\"noticia-imagen\" type=\"file\" accept=\"image/*\" className=\"hidden\" onChange={e => {\r\n                                            const file = e.target.files?.[0];\r\n                                            if (file) {\r\n                                                setNombreArchivo(file.name);\r\n                                                const reader = new FileReader();\r\n                                                reader.onload = (ev) => {\r\n                                                    setNoticiaImagen(ev.target?.result as string);\r\n                                                };\r\n                                                reader.readAsDataURL(file);\r\n                                            } else {\r\n                                                setNombreArchivo(\"\");\r\n                                                setNoticiaImagen(\"\");\r\n                                            }\r\n                                        }} />\r\n                                        <button type=\"button\" className=\"bg-gray-200 text-gray-700 px-4 py-2 rounded font-semibold border\" onClick={() => document.getElementById('noticia-imagen')?.click()}>Seleccionar imagen</button>\r\n                                        <button type=\"submit\" className=\"bg-blue-500 text-white px-4 py-2 rounded font-semibold\">Publicar noticia</button>\r\n                                    </div>\r\n                                </form>\r\n                            </div>\r\n                            <div className=\"bg-white shadow-lg rounded-lg p-6\">\r\n                                <h3 className=\"text-xl font-bold text-center mb-2\">Crear concurso</h3>\r\n                                <form className=\"w-full flex flex-col gap-4\" onSubmit={handleConcursoSubmit}>\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <input type=\"text\" className=\"border rounded px-3 py-2 flex-1\" placeholder={t('titulo')} value={concursoTitulo} onChange={e => setConcursoTitulo(e.target.value)} />\r\n                                        <span className=\"text-sm text-gray-500\">ID: {concursoId}</span>\r\n                                    </div>\r\n                                    <textarea className=\"border rounded px-3 py-2 w-full min-h-[80px]\" placeholder={t('descripcion')} value={concursoTexto} onChange={e => setConcursoTexto(e.target.value)} />\r\n                                    <div className=\"flex items-center gap-4\">\r\n                                        <div className=\"flex flex-col flex-1\">\r\n                                            <label className=\"text-sm mb-1\">{t('fechaInicio')}</label>\r\n                                            <input type=\"date\" className=\"border rounded px-3 py-2\" value={fechaInicio} onChange={e => setFechaInicio(e.target.value)} />\r\n                                        </div>\r\n                                        <div className=\"flex flex-col flex-1\">\r\n                                            <label className=\"text-sm mb-1\">{t('fechaFin')}</label>\r\n                                            <input type=\"date\" className=\"border rounded px-3 py-2\" value={fechaFin} onChange={e => setFechaFin(e.target.value)} />\r\n                                        </div>\r\n                                        <button type=\"button\" className=\"bg-blue-500 text-white px-4 py-2 rounded font-semibold\" onClick={handleConcursoSubmit}>{t('enviar')}</button>\r\n                                    </div>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                        {/* Gesti칩n de Concursos Finalizados - Solo para docentes */}\r\n                        <div className=\"w-full mt-6 pt-4 border-t border-gray-200\">\r\n                            <h4 className=\"text-lg font-semibold text-center mb-3 text-gray-700\">{t('gestionarConcursosFinalizados')}</h4>\r\n                            <div className=\"flex flex-col gap-3\">\r\n                                <select className=\"border rounded px-3 py-2 text-sm\" value={concursoSeleccionado} onChange={e => setConcursoSeleccionado(e.target.value)}>\r\n                                    <option value=\"\">{t('seleccionarConcurso')}</option>\r\n                                    {(() => {\r\n                                        const hoy = new Date();\r\n                                        return concursos\r\n                                            .filter((c: any) => {\r\n                                                if (!c.fin) return false;\r\n                                                const fechaFin = new Date(c.fin);\r\n                                                const ahora = new Date();\r\n                                                // Solo mostrar concursos del docente actual que hayan finalizado y sin ganador\r\n                                                return fechaFin < ahora && c.autor === user.nick && !c.ganador;\r\n                                            })\r\n                                            .map((c: any) => (\r\n                                                <option key={c.id} value={c.id}>\r\n                                                    {c.titulo} (ID: {c.numero}) - Sin ganador\r\n                                                </option>\r\n                                            ));\r\n                                    })()}\r\n                                </select>\r\n                                <select className=\"border rounded px-3 py-2 text-sm\" value={ganadorSeleccionado} onChange={e => setGanadorSeleccionado(e.target.value)}>\r\n                                    <option value=\"\">{t('seleccionarGanador')}</option>\r\n                                    {usuarios.sort((a, b) => a.nick.localeCompare(b.nick)).map((u, idx) => (\r\n                                        <option key={idx} value={u.nick}>{u.nick}</option>\r\n                                    ))}\r\n                                </select>\r\n                                <button className=\"bg-green-500 text-white px-4 py-2 rounded font-semibold text-sm\" onClick={handleAsignarGanador} disabled={!concursoSeleccionado || !ganadorSeleccionado}>\r\n                                    {t('asignarGanador')}\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"bg-white shadow-lg rounded-lg p-6 flex flex-col gap-4 mt-6\">\r\n                            <h3 className=\"text-xl font-bold text-center mb-2\">Agregar Pregunta - Aprende con Pipo</h3>\r\n                            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-blue-700 mb-2\">Curso:</label>\r\n                                    <select value={cursoSeleccionado} onChange={(e) => setCursoSeleccionado(e.target.value)} className=\"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\">\r\n                                        <option value=\"1primaria\">1췈 Primaria</option>\r\n                                        <option value=\"2primaria\">2췈 Primaria</option>\r\n                                        <option value=\"3primaria\">3췈 Primaria</option>\r\n                                        <option value=\"4primaria\">4췈 Primaria</option>\r\n                                        <option value=\"5primaria\">5췈 Primaria</option>\r\n                                        <option value=\"6primaria\">6췈 Primaria</option>\r\n                                    </select>\r\n                                </div>\r\n                                <div>\r\n                                    <label className=\"block text-sm font-medium text-blue-700 mb-2\">Asignatura:</label>\r\n                                    <select value={asignaturaSeleccionada} onChange={(e) => setAsignaturaSeleccionada(e.target.value)} className=\"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\">\r\n                                        <option value=\"campeonato\">Campeonato</option>\r\n                                        <option value=\"general\">General</option>\r\n                                        <option value=\"matematicas\">Matem치ticas</option>\r\n                                        <option value=\"lenguaje\">Lenguaje</option>\r\n                                        <option value=\"literatura\">Literatura</option>\r\n                                        <option value=\"historia\">Historia</option>\r\n                                        <option value=\"geografia\">Geograf칤a</option>\r\n                                        <option value=\"ingles\">Ingl칠s</option>\r\n                                        <option value=\"naturaleza\">Naturaleza</option>\r\n                                    </select>\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-blue-700 mb-2\">Pregunta:</label>\r\n                                <textarea value={pregunta} onChange={(e) => setPregunta(e.target.value)} placeholder=\"Escribe la pregunta aqu칤...\" className=\"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-20 resize-none\" />\r\n                            </div>\r\n                            <div>\r\n                                <label className=\"block text-sm font-medium text-blue-700 mb-2\">Respuesta:</label>\r\n                                <input type=\"text\" value={respuesta} onChange={(e) => setRespuesta(e.target.value)} placeholder=\"Escribe la respuesta aqu칤...\" className=\"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\" />\r\n                            </div>\r\n                            <div className=\"text-center\">\r\n                                <button onClick={enviarPregunta} className=\"bg-gradient-to-r from-green-500 to-green-600 text-white px-8 py-3 rounded-lg font-bold hover:shadow-lg transform hover:scale-105 transition-all\">\r\n                                    九 Enviar Pregunta\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"mt-4 p-3 bg-blue-100 border border-blue-300 rounded\">\r\n                                <p className=\"text-sm text-blue-800\">\r\n                                    <strong>游눠 Informaci칩n:</strong> Las preguntas se agregan autom치ticamente al archivo correspondiente\r\n                                    <code className=\"bg-blue-200 px-1 rounded\">{asignaturaSeleccionada}-{cursoSeleccionado}.json</code>\r\n                                </p>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {/* Panel de administraci칩n y antibullying solo para docentes */}\r\n                    {user.tipo && user.tipo.toLowerCase() === \"docente\" && (\r\n                        <div className=\"w-full max-w-6xl mx-auto mt-16 bg-white shadow-lg rounded-lg p-6 flex flex-col items-center\">\r\n                            <div className=\"w-full\">\r\n                                <h3 className=\"text-xl font-bold mb-4 text-center\">{t('panelAdministracion')}</h3>\r\n                                <form className=\"w-full flex flex-col items-center gap-4\" onSubmit={handlePalabraProhibidaSubmit}>\r\n                                    <div className=\"flex w-full max-w-xs items-center gap-2\">\r\n                                        <input type=\"text\" className=\"border rounded px-3 py-2 min-w-[280px] max-w-full\" placeholder={t('palabraProhibida')} value={palabraProhibida} onChange={e => setPalabraProhibida(e.target.value)} />\r\n                                        <button type=\"submit\" className=\"bg-red-500 text-white px-4 py-2 rounded font-semibold whitespace-nowrap\">Seleccionar</button>\r\n                                    </div>\r\n                                </form>\r\n                                <h4 className=\"text-lg font-semibold mt-6 text-center\">{t('sistemaAntibullying')}</h4>\r\n                                <div className=\"mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md text-gray-700 max-w-2xl mx-auto\">\r\n                                    <div className=\"flex flex-row items-start gap-8\">\r\n                                        <div className=\"flex-1\">\r\n                                            <p className=\"font-semibold mb-2\">{t('avisoAntibullying')}</p>\r\n                                            <ol className=\"list-decimal ml-6 space-y-1\">\r\n                                                <li>{t('historiasTerror')}</li>\r\n                                                <li>{t('perdidaLikes')}</li>\r\n                                                <li>{t('mensajesUsuario')}</li>\r\n                                                <li>{t('palabrasProhibidasChat')}</li>\r\n                                                <li>{t('actividadConsecutiva')}</li>\r\n                                            </ol>\r\n                                        </div>\r\n                                        <div className=\"flex flex-col items-center justify-center min-w-[180px]\">\r\n                                            <button type=\"button\" className={`relative w-32 h-32 rounded-full font-bold text-white text-lg mb-2 transition-all flex items-center justify-center ${bullyingActivo ? 'bg-red-600 opacity-100 shadow-lg animate-blink' : 'bg-green-600 opacity-40'}`} disabled={!bullyingActivo} onClick={handleApagarBullying}>\r\n                                                {bullyingActivo ? 'Aviso Antibullying' : t('sinPeligro')}\r\n                                                <span className=\"absolute inset-0 flex items-center justify-center pointer-events-none\">\r\n                                                    <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 100 100\" className=\"opacity-70\">\r\n                                                        <line x1=\"10\" y1=\"10\" x2=\"90\" y2=\"90\" stroke=\"white\" strokeWidth=\"10\" />\r\n                                                        <line x1=\"90\" y1=\"10\" x2=\"10\" y2=\"90\" stroke=\"white\" strokeWidth=\"10\" />\r\n                                                    </svg>\r\n                                                </span>\r\n                                            </button>\r\n                                            {usuarioBullying && (\r\n                                                <div className=\"text-center text-red-700 font-semibold text-base\">{usuarioBullying}</div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n\r\n}\r\nexport default PerfilUsuario;\r\n"],"names":[],"mappings":"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","debugId":null}}]
}