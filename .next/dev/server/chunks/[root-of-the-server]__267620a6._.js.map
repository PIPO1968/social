{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/utils/jwt.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';\r\n\r\nexport function signToken(payload: any): string {\r\n    return jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' });\r\n}\r\n\r\nexport function verifyToken(token: string): any {\r\n    try {\r\n        return jwt.verify(token, JWT_SECRET);\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAY;IAClC,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AAC3D;AAEO,SAAS,YAAY,KAAa;IACrC,IAAI;QACA,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ","debugId":null}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { PrismaClient } from '@prisma/client';\r\nimport bcrypt from 'bcryptjs';\r\nimport { signToken } from '@/utils/jwt';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        const { email, password } = body;\r\n\r\n        if (!email || !password) {\r\n            return NextResponse.json({ error: 'Email y contraseña requeridos' }, { status: 400 });\r\n        }\r\n\r\n        // Buscar usuario por email\r\n        const user = await prisma.user.findUnique({\r\n            where: { email: email },\r\n            select: {\r\n                id: true,\r\n                nick: true,\r\n                email: true,\r\n                password: true\r\n            }\r\n        });\r\n\r\n        if (!user || !user.password) {\r\n            return NextResponse.json({ error: 'Credenciales inválidas' }, { status: 401 });\r\n        }\r\n\r\n        // Verificar contraseña\r\n        const isValid = await bcrypt.compare(password, user.password);\r\n        if (!isValid) {\r\n            return NextResponse.json({ error: 'Credenciales inválidas' }, { status: 401 });\r\n        }\r\n\r\n        // Crear token JWT\r\n        const token = signToken({ userId: user.id, nick: user.nick });\r\n\r\n        // Devolver usuario sin contraseña\r\n        const { password: _, ...userWithoutPassword } = user;\r\n\r\n        const response = NextResponse.json({ user: userWithoutPassword });\r\n\r\n        // Setear cookie con el token\r\n        response.cookies.set('auth-token', token, {\r\n            httpOnly: true,\r\n            secure: process.env.NODE_ENV === 'production',\r\n            sameSite: process.env.NODE_ENV === 'production' ? 'strict' : 'lax',\r\n            maxAge: 60 * 60 * 24 * 7, // 7 días\r\n            domain: undefined\r\n        });\r\n\r\n        return response;\r\n    } catch (error) {\r\n        console.error('Error en login:', error);\r\n        return NextResponse.json({ error: 'Error interno del servidor' }, { status: 500 });\r\n    }\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAExB,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;QAE5B,IAAI,CAAC,SAAS,CAAC,UAAU;YACrB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,2BAA2B;QAC3B,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;YACtC,OAAO;gBAAE,OAAO;YAAM;YACtB,QAAQ;gBACJ,IAAI;gBACJ,MAAM;gBACN,OAAO;gBACP,UAAU;YACd;QACJ;QAEA,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;YACzB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,uBAAuB;QACvB,MAAM,UAAU,MAAM,8IAAM,CAAC,OAAO,CAAC,UAAU,KAAK,QAAQ;QAC5D,IAAI,CAAC,SAAS;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyB,GAAG;gBAAE,QAAQ;YAAI;QAChF;QAEA,kBAAkB;QAClB,MAAM,QAAQ,IAAA,kIAAS,EAAC;YAAE,QAAQ,KAAK,EAAE;YAAE,MAAM,KAAK,IAAI;QAAC;QAE3D,kCAAkC;QAClC,MAAM,EAAE,UAAU,CAAC,EAAE,GAAG,qBAAqB,GAAG;QAEhD,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAoB;QAE/D,6BAA6B;QAC7B,SAAS,OAAO,CAAC,GAAG,CAAC,cAAc,OAAO;YACtC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU,sCAAwC,0BAAW;YAC7D,QAAQ,KAAK,KAAK,KAAK;YACvB,QAAQ;QACZ;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA6B,GAAG;YAAE,QAAQ;QAAI;IACpF;AACJ","debugId":null}}]
}