{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/app/api/concursos/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { PrismaClient } from '@prisma/client';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nexport async function GET() {\r\n    try {\r\n        const concursos = await prisma.concurso.findMany({\r\n            orderBy: { numero: 'desc' }\r\n        });\r\n        return NextResponse.json(concursos);\r\n    } catch (error) {\r\n        console.error('Error fetching concursos:', error);\r\n        return NextResponse.json({ error: 'Error fetching concursos' }, { status: 500 });\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const body = await request.json();\r\n        if (body.id) {\r\n            // Update\r\n            const { id, ganador } = body;\r\n            const concurso = await prisma.concurso.update({\r\n                where: { id: parseInt(id) },\r\n                data: { ganador }\r\n            });\r\n            return NextResponse.json(concurso);\r\n        } else {\r\n            // Create\r\n            const { numero, titulo, texto, inicio, fin, autor, ganador, fechaFinal } = body;\r\n\r\n            const user = await prisma.user.findUnique({ where: { nick: autor } });\r\n            if (!user) {\r\n                return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n            }\r\n\r\n            const concurso = await prisma.concurso.create({\r\n                data: {\r\n                    numero,\r\n                    titulo,\r\n                    texto,\r\n                    inicio: new Date(inicio),\r\n                    fin: new Date(fin),\r\n                    autor,\r\n                    ganador,\r\n                    fechaFinal: fechaFinal ? new Date(fechaFinal) : null,\r\n                    userId: user.id\r\n                }\r\n            });\r\n            return NextResponse.json(concurso);\r\n        }\r\n    } catch (error) {\r\n        console.error('Error creating/updating concurso:', error);\r\n        return NextResponse.json({ error: 'Error creating/updating concurso' }, { status: 500 });\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,SAAS,IAAI,6IAAY;AAExB,eAAe;IAClB,IAAI;QACA,MAAM,YAAY,MAAM,OAAO,QAAQ,CAAC,QAAQ,CAAC;YAC7C,SAAS;gBAAE,QAAQ;YAAO;QAC9B;QACA,OAAO,gJAAY,CAAC,IAAI,CAAC;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA2B,GAAG;YAAE,QAAQ;QAAI;IAClF;AACJ;AAEO,eAAe,KAAK,OAAoB;IAC3C,IAAI;QACA,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,IAAI,KAAK,EAAE,EAAE;YACT,SAAS;YACT,MAAM,EAAE,EAAE,EAAE,OAAO,EAAE,GAAG;YACxB,MAAM,WAAW,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;gBAC1C,OAAO;oBAAE,IAAI,SAAS;gBAAI;gBAC1B,MAAM;oBAAE;gBAAQ;YACpB;YACA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAC7B,OAAO;YACH,SAAS;YACT,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG;YAE3E,MAAM,OAAO,MAAM,OAAO,IAAI,CAAC,UAAU,CAAC;gBAAE,OAAO;oBAAE,MAAM;gBAAM;YAAE;YACnE,IAAI,CAAC,MAAM;gBACP,OAAO,gJAAY,CAAC,IAAI,CAAC;oBAAE,OAAO;gBAAiB,GAAG;oBAAE,QAAQ;gBAAI;YACxE;YAEA,MAAM,WAAW,MAAM,OAAO,QAAQ,CAAC,MAAM,CAAC;gBAC1C,MAAM;oBACF;oBACA;oBACA;oBACA,QAAQ,IAAI,KAAK;oBACjB,KAAK,IAAI,KAAK;oBACd;oBACA;oBACA,YAAY,aAAa,IAAI,KAAK,cAAc;oBAChD,QAAQ,KAAK,EAAE;gBACnB;YACJ;YACA,OAAO,gJAAY,CAAC,IAAI,CAAC;QAC7B;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAmC,GAAG;YAAE,QAAQ;QAAI;IAC1F;AACJ","debugId":null}}]
}