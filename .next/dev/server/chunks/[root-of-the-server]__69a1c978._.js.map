{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/utils/jwt.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key';\r\n\r\nexport function signToken(payload: any): string {\r\n    return jwt.sign(payload, JWT_SECRET, { expiresIn: '7d' });\r\n}\r\n\r\nexport function verifyToken(token: string): any {\r\n    try {\r\n        return jwt.verify(token, JWT_SECRET);\r\n    } catch (error) {\r\n        return null;\r\n    }\r\n}"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,UAAU,OAAY;IAClC,OAAO,kJAAG,CAAC,IAAI,CAAC,SAAS,YAAY;QAAE,WAAW;IAAK;AAC3D;AAEO,SAAS,YAAY,KAAa;IACrC,IAAI;QACA,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC7B,EAAE,OAAO,OAAO;QACZ,OAAO;IACX;AACJ","debugId":null}},
    {"offset": {"line": 101, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/user/Desktop/social/src/app/api/premium/data/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport { PrismaClient } from '@prisma/client';\r\nimport { verifyToken } from '@/utils/jwt';\r\n\r\nconst prisma = new PrismaClient();\r\n\r\nexport async function GET(request: NextRequest) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const nick = searchParams.get('nick');\r\n\r\n        if (nick) {\r\n            const user = await prisma.user.findUnique({ where: { nick } });\r\n            if (!user) {\r\n                return NextResponse.json({ error: 'User not found' }, { status: 404 });\r\n            }\r\n            const premiumData = await prisma.premiumData.findUnique({\r\n                where: { userId: user.id }\r\n            });\r\n            return NextResponse.json(premiumData || {});\r\n        } else {\r\n            const token = request.cookies.get('auth-token')?.value;\r\n            if (!token) {\r\n                return NextResponse.json({ error: 'No autenticado' }, { status: 401 });\r\n            }\r\n\r\n            const decoded = verifyToken(token);\r\n            if (!decoded) {\r\n                return NextResponse.json({ error: 'Token inválido' }, { status: 401 });\r\n            }\r\n\r\n            const premiumData = await prisma.premiumData.findUnique({\r\n                where: { userId: decoded.userId }\r\n            });\r\n\r\n            return NextResponse.json(premiumData || {});\r\n        }\r\n    } catch (error) {\r\n        console.error('Error obteniendo datos premium:', error);\r\n        return NextResponse.json({ error: 'Error interno del servidor' }, { status: 500 });\r\n    } finally {\r\n        await prisma.$disconnect();\r\n    }\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n    try {\r\n        const token = request.cookies.get('auth-token')?.value;\r\n        if (!token) {\r\n            return NextResponse.json({ error: 'No autenticado' }, { status: 401 });\r\n        }\r\n\r\n        const decoded = verifyToken(token);\r\n        if (!decoded) {\r\n            return NextResponse.json({ error: 'Token inválido' }, { status: 401 });\r\n        }\r\n\r\n        const { fechaInicio, fechaExpiracion, activo } = await request.json();\r\n\r\n        const premiumData = await prisma.premiumData.upsert({\r\n            where: { userId: decoded.userId },\r\n            update: {\r\n                fechaInicio: fechaInicio ? new Date(fechaInicio) : undefined,\r\n                fechaExpiracion: fechaExpiracion ? new Date(fechaExpiracion) : undefined,\r\n                activo: activo ?? undefined\r\n            },\r\n            create: {\r\n                userId: decoded.userId,\r\n                fechaInicio: fechaInicio ? new Date(fechaInicio) : undefined,\r\n                fechaExpiracion: fechaExpiracion ? new Date(fechaExpiracion) : undefined,\r\n                activo: activo ?? false\r\n            }\r\n        });\r\n\r\n        // Sincronizar el campo premium en User\r\n        if (activo === true) {\r\n            await prisma.user.update({ where: { id: decoded.userId }, data: { premium: true } });\r\n        } else if (activo === false) {\r\n            await prisma.user.update({ where: { id: decoded.userId }, data: { premium: false } });\r\n        }\r\n\r\n        return NextResponse.json(premiumData);\r\n    } catch (error) {\r\n        console.error('Error guardando datos premium:', error);\r\n        return NextResponse.json({ error: 'Error interno del servidor' }, { status: 500 });\r\n    } finally {\r\n        await prisma.$disconnect();\r\n    }\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}