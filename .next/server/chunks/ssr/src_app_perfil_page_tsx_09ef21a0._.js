module.exports=[45246,a=>{"use strict";var b=a.i(87924),c=a.i(72131);let d=a.i(85315).default.map(a=>({src:a.imagen,texto:`${a.titulo}
${a.descripcion}`,tipo:"manual"}));var e=a.i(44355),f=a.i(50944);a.s(["default",0,()=>{let a=(0,f.useRouter)(),[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(""),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(1),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)([]),[E,F]=(0,c.useState)(""),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)([]),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(""),[S,T]=(0,c.useState)(""),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(""),[Y,Z]=(0,c.useState)(null),[$,_]=(0,c.useState)(null),[aa,ab]=(0,c.useState)({trofeosDesbloqueados:[],trofeosBloqueados:[]}),[ac,ad]=(0,c.useState)([]),[ae,af]=(0,c.useState)("1primaria"),[ag,ah]=(0,c.useState)("matematicas"),[ai,aj]=(0,c.useState)(""),[ak,al]=(0,c.useState)(""),{t:am}=(0,e.useTranslation)();(0,c.useEffect)(()=>{fetch("/api/auth/me").then(b=>b.ok?b.json():(a.push("/"),null)).then(b=>{b&&b.user?h(b.user):b&&!b.user&&a.push("/")}).catch(a=>{console.warn("Error comprobando sesión:",a)}),fetch("/api/concursos").then(a=>a.json()).then(a=>{ad(a)}).catch(a=>{console.warn("No se pudo cargar la lista de concursos:",a)})},[]),(0,c.useEffect)(()=>{g&&g.nick&&fetch("/api/chat?nick="+g.nick).then(a=>a.json()).then(a=>{J(a)}).catch(a=>{console.warn("No se pudo cargar los mensajes del chat:",a)})},[g]);let an=E&&Y||{...g,trofeosDesbloqueados:aa.trofeosDesbloqueados,trofeosBloqueados:aa.trofeosBloqueados};(0,c.useEffect)(()=>{an&&an.nick&&(fetch("/api/premium/data?nick="+an.nick).then(a=>a.json()).then(a=>_(a)).catch(a=>console.warn("No se pudo cargar datos premium:",a)),fetch("/api/trofeos/user-trofeos?nick="+an.nick).then(a=>a.json()).then(a=>ab(a)).catch(a=>console.warn("No se pudo cargar trofeos:",a)))},[an]);let ao=async()=>{if(U&&W)try{await fetch("/api/concursos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:U,ganador:W})}),((a,b)=>{if(!a)return;let c=C.find(b=>b.nick===a)?.likes||0;fetch("/api/users/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:a,likes:c+10})}).then(a=>a.json()).then(b=>{D(C.map(c=>c.nick===a?b:c)),g&&g.nick===a&&h(b)}).catch(a=>console.error("Error updating likes:",a))})(W,0),V(""),X(""),fetch("/api/concursos").then(a=>a.json()).then(ad)}catch(a){console.error("Error asignando ganador:",a)}},ap=async()=>{if(ai.trim()&&ak.trim())try{let a=await fetch("/api/add-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({curso:ae,asignatura:ag,pregunta:ai.trim(),respuesta:ak.trim()})});await a.json(),a.ok&&(aj(""),al(""))}catch(a){console.error("Error al enviar pregunta:",a)}};return([...d],g)?(an&&$&&$.activo,(0,b.jsx)("div",{className:"min-h-screen bg-green-100 flex flex-col pt-4",children:g.tipo&&"docente"===g.tipo.toLowerCase()&&(0,b.jsxs)("div",{className:"w-full max-w-6xl mx-auto mt-16 grid grid-cols-2 gap-12",children:[(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),fetch("/api/noticias",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titulo:M,contenido:O,autorNick:g?g.nick:""})}).then(a=>a.json()).then(()=>{N(""),P(""),R("")}).catch(a=>{console.error("Error creando noticia:",a)})},className:"bg-white shadow rounded p-6 mb-8 flex flex-col gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Crear noticia"}),(0,b.jsx)("input",{type:"text",value:M,onChange:a=>N(a.target.value),placeholder:"Título",className:"border p-2 rounded"}),(0,b.jsx)("textarea",{value:O,onChange:a=>P(a.target.value),placeholder:"Contenido",className:"border p-2 rounded"}),(0,b.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded",children:"Publicar noticia"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),fetch("/api/concursos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numero:y,titulo:o,texto:q,inicio:s,fin:u,autor:g?g.nick:"",ganador:w,fechaFinal:u})}).then(a=>a.json()).then(()=>{z(y+1),p(""),r(""),t(""),v(""),x(""),fetch("/api/concursos").then(a=>a.json()).then(ad)}).catch(a=>{console.error("Error creando concurso:",a)})},className:"bg-white shadow rounded p-6 mb-8 flex flex-col gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Crear concurso"}),(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),placeholder:"Título",className:"border p-2 rounded"}),(0,b.jsx)("textarea",{value:q,onChange:a=>r(a.target.value),placeholder:"Descripción",className:"border p-2 rounded"}),(0,b.jsx)("input",{type:"date",value:s,onChange:a=>t(a.target.value),className:"border p-2 rounded"}),(0,b.jsx)("input",{type:"date",value:u,onChange:a=>v(a.target.value),className:"border p-2 rounded"}),(0,b.jsx)("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded",children:"Crear concurso"})]}),(0,b.jsxs)("div",{className:"bg-white shadow rounded p-6 mb-8 flex flex-col gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Gestión de concursos finalizados"}),(0,b.jsxs)("select",{value:U,onChange:a=>V(a.target.value),className:"border p-2 rounded",children:[(0,b.jsx)("option",{value:"",children:"Selecciona concurso"}),ac.map(a=>(0,b.jsx)("option",{value:a.id,children:a.titulo},a.id))]}),(0,b.jsx)("input",{type:"text",value:W,onChange:a=>X(a.target.value),placeholder:"Nick del ganador",className:"border p-2 rounded"}),(0,b.jsx)("button",{type:"button",onClick:ao,className:"bg-yellow-500 text-white px-4 py-2 rounded",children:"Asignar ganador"})]}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),ap()},className:"bg-white shadow rounded p-6 mb-8 flex flex-col gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Agregar pregunta (Aprende con Pipo)"}),(0,b.jsxs)("select",{value:ae,onChange:a=>af(a.target.value),className:"border p-2 rounded",children:[(0,b.jsx)("option",{value:"1primaria",children:"1º Primaria"}),(0,b.jsx)("option",{value:"2primaria",children:"2º Primaria"}),(0,b.jsx)("option",{value:"3primaria",children:"3º Primaria"}),(0,b.jsx)("option",{value:"4primaria",children:"4º Primaria"}),(0,b.jsx)("option",{value:"5primaria",children:"5º Primaria"}),(0,b.jsx)("option",{value:"6primaria",children:"6º Primaria"})]}),(0,b.jsxs)("select",{value:ag,onChange:a=>ah(a.target.value),className:"border p-2 rounded",children:[(0,b.jsx)("option",{value:"matematicas",children:"Matemáticas"}),(0,b.jsx)("option",{value:"lenguaje",children:"Lenguaje"}),(0,b.jsx)("option",{value:"ciencias",children:"Ciencias"}),(0,b.jsx)("option",{value:"ingles",children:"Inglés"}),(0,b.jsx)("option",{value:"historia",children:"Historia"}),(0,b.jsx)("option",{value:"geografia",children:"Geografía"}),(0,b.jsx)("option",{value:"literatura",children:"Literatura"})]}),(0,b.jsx)("input",{type:"text",value:ai,onChange:a=>aj(a.target.value),placeholder:"Pregunta",className:"border p-2 rounded"}),(0,b.jsx)("input",{type:"text",value:ak,onChange:a=>al(a.target.value),placeholder:"Respuesta",className:"border p-2 rounded"}),(0,b.jsx)("button",{type:"submit",className:"bg-purple-500 text-white px-4 py-2 rounded",children:"Agregar pregunta"})]}),(0,b.jsxs)("div",{className:"bg-white shadow rounded p-6 mb-8 flex flex-col gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold mb-2",children:"Panel de administración y antibullying"}),(0,b.jsxs)("form",{onSubmit:a=>{a.preventDefault(),n("")},className:"flex gap-2 mb-2",children:[(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"Palabra prohibida",className:"border p-2 rounded"}),(0,b.jsx)("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded",children:"Agregar palabra"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{j(!1),l("")},className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Desactivar antibullying"}),i&&(0,b.jsxs)("div",{className:"text-red-600 font-bold",children:["Antibullying activo para: ",k]})]})]})})):(0,b.jsx)("div",{className:"min-h-screen bg-green-100 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"max-w-md w-full bg-white shadow rounded p-6 text-center",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Perfil"}),(0,b.jsx)("p",{className:"text-gray-600",children:"No se ha iniciado sesión."})]})})}],45246)}];

//# sourceMappingURL=src_app_perfil_page_tsx_09ef21a0._.js.map