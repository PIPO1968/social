{"version":3,"sources":["turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","turbopack:///[project]/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","turbopack:///[project]/src/components/UserLink.tsx","turbopack:///[project]/src/utils/renderNick.tsx","turbopack:///[project]/src/app/historias/[id]/page.tsx"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","import React, { useState, useEffect } from \"react\";\r\n\r\ninterface UserLinkProps {\r\n    nick: string;\r\n    className?: string;\r\n}\r\n\r\nexport const UserLink: React.FC<UserLinkProps> = ({ nick, className }) => {\r\n    const [isPremium, setIsPremium] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const checkPremium = async () => {\r\n            if (nick) {\r\n                try {\r\n                    const response = await fetch(`/api/user/premium-status?nick=${encodeURIComponent(nick)}`);\r\n                    const data = await response.json();\r\n                    setIsPremium(data.isPremium || false);\r\n                } catch (error) {\r\n                    setIsPremium(false);\r\n                }\r\n            }\r\n        };\r\n\r\n        // Verificar inicialmente\r\n        checkPremium();\r\n    }, [nick]);\r\n\r\n    const normalized = (nick || \"\").trim().toLowerCase();\r\n    if (!nick || normalized === \"anonimo\" || normalized === \"an√≥nimo\") {\r\n        return <span className={className || \"text-gray-500\"}>{nick || \"(sin nick)\"}</span>;\r\n    }\r\n\r\n    return (\r\n        <a\r\n            href={`/perfil/${encodeURIComponent(nick)}`}\r\n            className={className || \"text-blue-600 underline hover:text-blue-800\"}\r\n            title={`Ver perfil de ${nick}${isPremium ? ' (Usuario Premium)' : ''}`}\r\n        >\r\n            {nick}\r\n            {isPremium && (\r\n                <span className=\"ml-1 inline-flex items-center\">\r\n                    <span\r\n                        className=\"bg-gradient-to-r from-sky-100 to-blue-100 text-amber-900 text-xs px-2 py-1 rounded-full font-bold shadow-md border border-sky-300\"\r\n                        title=\"Usuario Premium\"\r\n                    >\r\n                        üëë\r\n                    </span>\r\n                </span>\r\n            )}\r\n        </a>\r\n    );\r\n};\r\n","import React from \"react\";\r\nimport { UserLink } from \"@/components/UserLink\";\r\n\r\nexport function renderNick(nick: string, className?: string) {\r\n    return <UserLink nick={nick} className={className} />;\r\n}\r\n","\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { renderNick } from \"@/utils/renderNick\";\r\nimport { useParams } from 'next/navigation';\r\n\r\n// Definici√≥n de tipos\r\ninterface User {\r\n    nick: string;\r\n    nombre?: string;\r\n    usuario?: string;\r\n    likes?: number;\r\n    comentariosRecibidos?: number;\r\n}\r\n\r\ninterface Historia {\r\n    id: number;\r\n    titulo: string;\r\n    autor: string;\r\n    fecha: string;\r\n    contenido?: string;\r\n    imagen?: string;\r\n    likes?: number;\r\n    likedBy?: string[];\r\n    comentarios?: Comentario[];\r\n}\r\n\r\ninterface Comentario {\r\n    usuario: string;\r\n    texto: string;\r\n    fecha: string;\r\n}\r\n\r\nexport default function HistoriaDetalle() {\r\n    const params = useParams();\r\n    const id = params?.id;\r\n    const [historia, setHistoria] = useState<any>(null);\r\n    const [comentario, setComentario] = useState(\"\");\r\n    const [comentarios, setComentarios] = useState<any[]>([]);\r\n    const [likes, setLikes] = useState(0);\r\n    const [liked, setLiked] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (id) {\r\n            fetch(`/api/historias/${id}`)\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    setHistoria(data);\r\n                    setLikes(data.likes || 0);\r\n                    setComentarios(data.comentarios || []);\r\n                    // No hay likedBy en DB, as√≠ que no setLiked\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error cargando historia:', error);\r\n                });\r\n        }\r\n    }, [id]);\r\n\r\n    const handleLike = () => {\r\n        if (historia) {\r\n            fetch(`/api/historias/${historia.id}/like`, {\r\n                method: 'POST'\r\n            })\r\n                .then(response => response.json())\r\n                .then(data => {\r\n                    setLikes(data.likes);\r\n                    setLiked(true); // Simplificar, no manejar quitar like\r\n                })\r\n                .catch(error => {\r\n                    console.error('Error dando like:', error);\r\n                });\r\n        }\r\n    };\r\n\r\n    const handleComentar = () => {\r\n        if (!comentario.trim()) return;\r\n        // Comentarios no implementados en DB a√∫n\r\n        alert(\"Comentarios no disponibles por ahora.\");\r\n        setComentario(\"\");\r\n    };\r\n\r\n    if (!historia) {\r\n        return <div className=\"min-h-screen bg-green-100 p-8\">Cargando historia...</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-green-100 p-8\">\r\n            <div className=\"bg-white rounded-lg shadow-md p-6 max-w-2xl mx-auto\">\r\n                <h1 className=\"text-2xl font-bold mb-2\">{historia.titulo}</h1>\r\n                <div className=\"mb-2 text-gray-700\">Por: {renderNick(historia.autor)} | {historia.fecha}</div>\r\n                {historia.imagen && (\r\n                    <img src={historia.imagen} alt=\"Imagen\" className=\"mb-4 max-h-64 rounded\" />\r\n                )}\r\n                <div className=\"border rounded p-4 mb-4 bg-gray-50\" dangerouslySetInnerHTML={{ __html: historia.contenido }} />\r\n                <div className=\"flex items-center gap-4 mb-4\">\r\n                    <button\r\n                        className={`font-bold py-2 px-4 rounded ${liked ? \"bg-gray-400\" : \"bg-pink-500 hover:bg-pink-600 text-white\"}`}\r\n                        onClick={handleLike}\r\n                    >\r\n                        {liked ? `üíî (${likes})` : `‚ù§Ô∏è Like (${likes === 0 ? \"0\" : likes})`}\r\n                    </button>\r\n                </div>\r\n                <div className=\"mb-4\">\r\n                    <h2 className=\"font-bold mb-2\">Comentarios</h2>\r\n                    <ul className=\"mb-2\">\r\n                        {comentarios.slice(-5).map((c, idx) => (\r\n                            <li key={idx} className=\"border-b py-1 text-gray-800\">\r\n                                <span>{c.texto}</span>\r\n                                <span className=\"ml-2 text-xs text-gray-500\">{c.fecha}</span>\r\n                            </li>\r\n                        ))}\r\n                    </ul>\r\n                    <div className=\"flex gap-2\">\r\n                        <input\r\n                            type=\"text\"\r\n                            value={comentario}\r\n                            onChange={e => setComentario(e.target.value)}\r\n                            placeholder=\"Escribe un comentario...\"\r\n                            className=\"border rounded px-2 py-1 flex-1\"\r\n                        />\r\n                        <button className=\"bg-green-500 hover:bg-green-600 text-white font-bold px-4 rounded\" onClick={handleComentar}>\r\n                            Comentar\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n"],"names":["module","exports","require","vendored","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1]}