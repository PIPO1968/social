(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},59336,e=>{"use strict";var t=e.i(43476),a=e.i(71645),i=e.i(18566);e.s(["default",0,()=>{let e=(0,i.useRouter)(),[s,r]=(0,a.useState)(null),[n,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(!0),[d,p]=(0,a.useState)([]),[m,u]=(0,a.useState)(null),[x,h]=(0,a.useState)(1);(0,a.useEffect)(()=>{(async()=>{try{let t=await fetch("/api/auth/me");if(!t.ok)return void e.push("/");let a=await t.json();r(a);let i=1;if(a.esProfesor||"docente"===a.tipo||"Docente"===a.tipo)i=6;else if(a.curso)if("string"==typeof a.curso){let e=a.curso.match(/(\d)/);e&&(i=parseInt(e[1]))}else"number"==typeof a.curso&&(i=a.curso);i<1&&(i=1),i>6&&(i=6),h(i);let s=await fetch("/api/premium/data");if(s.ok){let t=await s.json();t.activo&&t.fechaExpiracion&&new Date(t.fechaExpiracion)>new Date?(o(!0),await f()):e.push("/premium-nuevo")}else e.push("/premium-nuevo")}catch(t){console.error("Error loading user:",t),e.push("/")}c(!1)})()},[]);let g=e=>{let t=e.match(/torneo-mensual-(\d)primaria/);return!!t&&parseInt(t[1])===x},f=async()=>{try{let e=await fetch("/api/premium/torneos");if(e.ok){let t=await e.json();if(t.torneos)return void p(t.torneos)}}catch(e){console.error("Error loading torneos:",e)}let e=new Date().getMonth(),t=new Date().getFullYear(),a=[{id:"torneo-mensual-1primaria",nombre:"Torneo Mensual 1¬∫ Primaria",descripcion:"Compite en el torneo mensual de 1¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"},{id:"torneo-mensual-2primaria",nombre:"Torneo Mensual 2¬∫ Primaria",descripcion:"Compite en el torneo mensual de 2¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"},{id:"torneo-mensual-3primaria",nombre:"Torneo Mensual 3¬∫ Primaria",descripcion:"Compite en el torneo mensual de 3¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"},{id:"torneo-mensual-4primaria",nombre:"Torneo Mensual 4¬∫ Primaria",descripcion:"Compite en el torneo mensual de 4¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"},{id:"torneo-mensual-5primaria",nombre:"Torneo Mensual 5¬∫ Primaria",descripcion:"Compite en el torneo mensual de 5¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"},{id:"torneo-mensual-6primaria",nombre:"Torneo Mensual 6¬∫ Primaria",descripcion:"Compite en el torneo mensual de 6¬∫ Primaria. 25 preguntas de asignaturas generales.",fechaInicio:new Date().toISOString(),fechaFin:new Date(t,e+1,0).toISOString(),categoria:"general",premio:"Medalla Especial + 200 puntos Liga Premium",maxParticipantes:16,participantes:[],estado:"registro"}];p(a),await fetch("/api/premium/torneos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({torneos:a,lastReset:new Date().toISOString()})})},b=async e=>{if(!s)return;let t=d.map(t=>t.id===e?t.participantes.includes(s.nick)||t.participantes.length>=t.maxParticipantes?t:{...t,participantes:[...t.participantes,s.nick]}:t);p(t),await fetch("/api/premium/torneos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({torneos:t})})},j=async t=>{await fetch("/api/premium/torneos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({torneoActivo:{torneoId:t.id,curso:t.id.split("-")[2],startTime:new Date().toISOString()}})}),e.push("/aprende-con-pipo?modo=torneo")};return l?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-white text-xl",children:"Cargando Torneos Premium..."})}):n?(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-blue-600 to-indigo-700 p-8",children:(0,t.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"üéØ Torneos Premium"}),(0,t.jsx)("p",{className:"text-purple-100 text-lg",children:"Compite en torneos exclusivos y gana premios especiales"})]}),m?(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 text-center",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-4",children:m.nombre}),(0,t.jsx)("div",{className:"text-6xl mb-4",children:"üéØ"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Torneo en progreso..."}),(0,t.jsx)("div",{className:"animate-spin text-4xl",children:"‚è≥"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-4",children:"Calculando resultados..."})]}):(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(e=>(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-xl overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-purple-500 to-blue-500 p-4",children:(0,t.jsx)("h3",{className:"text-lg font-bold text-white",children:e.nombre})}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:e.descripcion}),(0,t.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Categor√≠a:"}),(0,t.jsx)("span",{className:"font-semibold text-purple-600",children:e.categoria})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Participantes:"}),(0,t.jsxs)("span",{className:"font-semibold",children:[e.participantes.length,"/",e.maxParticipantes]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-500",children:"Estado:"}),(0,t.jsx)("span",{className:`font-semibold ${"registro"===e.estado?"text-green-600":"finalizado"===e.estado?"text-gray-600":"text-blue-600"}`,children:"registro"===e.estado?"Abierto":"finalizado"===e.estado?"Finalizado":"Disponible"})]})]}),(0,t.jsxs)("div",{className:"bg-yellow-50 p-3 rounded mb-4",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-yellow-800",children:"üèÜ Premio:"}),(0,t.jsx)("p",{className:"text-sm text-yellow-700",children:e.premio})]}),"finalizado"===e.estado&&e.ganador&&(0,t.jsxs)("div",{className:"bg-green-50 p-3 rounded mb-4",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-green-800",children:"ü•á Ganador:"}),(0,t.jsx)("p",{className:"text-sm text-green-700",children:e.ganador}),e.resultados&&e.resultados.length>0&&(0,t.jsxs)("div",{className:"mt-2",children:[(0,t.jsx)("p",{className:"text-xs text-green-600",children:"Top 3:"}),e.resultados.slice(0,3).map((e,a)=>(0,t.jsxs)("p",{className:"text-xs",children:[a+1,". ",e.nick," - ",e.aciertos,"/25 (",e.puntuacion,"pts)"]},a))]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:["registro"===e.estado&&!e.participantes.includes(s.nick)&&g(e.id)&&(0,t.jsx)("button",{onClick:()=>b(e.id),disabled:e.participantes.length>=e.maxParticipantes,className:"flex-1 bg-purple-600 text-white px-4 py-2 rounded font-semibold hover:bg-purple-700 disabled:bg-gray-400 transition-colors",children:"Registrarse"}),"registro"===e.estado&&!e.participantes.includes(s.nick)&&!g(e.id)&&(0,t.jsxs)("span",{className:"flex-1 text-center bg-gray-100 text-gray-600 px-4 py-2 rounded font-semibold",children:["Solo para ",e.nombre.split(" ")[2]," ",e.nombre.split(" ")[3]]}),e.participantes.includes(s.nick)&&"registro"===e.estado&&(0,t.jsx)("span",{className:"flex-1 text-center bg-green-100 text-green-800 px-4 py-2 rounded font-semibold",children:"‚úì Registrado"}),e.participantes.includes(s.nick)&&(0,t.jsx)("button",{onClick:()=>j(e),className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded font-semibold hover:bg-blue-700 transition-colors",children:"Comenzar Torneo"})]})]})]},e.id))}),(0,t.jsxs)("div",{className:"mt-8 bg-white/10 backdrop-blur-sm rounded-lg p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-white mb-4",children:"üìä Tus Estad√≠sticas en Torneos"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[(0,t.jsxs)("div",{className:"bg-white/20 rounded p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:(()=>{let[e,t]=(0,a.useState)({victorias:0,participaciones:0,puntuacionTotal:0});return(0,a.useEffect)(()=>{fetch("/api/premium/competiciones").then(e=>e.ok?e.json():{victorias:0,participaciones:0,puntuacionTotal:0}).then(t)},[]),e.victorias})()}),(0,t.jsx)("div",{className:"text-purple-100",children:"Victorias"})]}),(0,t.jsxs)("div",{className:"bg-white/20 rounded p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:(()=>{let[e,t]=(0,a.useState)({victorias:0,participaciones:0,puntuacionTotal:0});return(0,a.useEffect)(()=>{fetch("/api/premium/competiciones").then(e=>e.ok?e.json():{victorias:0,participaciones:0,puntuacionTotal:0}).then(t)},[]),e.participaciones})()}),(0,t.jsx)("div",{className:"text-purple-100",children:"Participaciones"})]}),(0,t.jsxs)("div",{className:"bg-white/20 rounded p-4",children:[(0,t.jsxs)("div",{className:"text-2xl font-bold text-white",children:[(()=>{let[e,t]=(0,a.useState)({victorias:0,participaciones:0,puntuacionTotal:0});return(0,a.useEffect)(()=>{fetch("/api/premium/competiciones").then(e=>e.ok?e.json():{victorias:0,participaciones:0,puntuacionTotal:0}).then(t)},[]),e.participaciones>0?Math.round(e.victorias/e.participaciones*100):0})(),"%"]}),(0,t.jsx)("div",{className:"text-purple-100",children:"Tasa de Victoria"})]}),(0,t.jsxs)("div",{className:"bg-white/20 rounded p-4",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-white",children:(()=>{let[e,t]=(0,a.useState)({victorias:0,participaciones:0,puntuacionTotal:0});return(0,a.useEffect)(()=>{fetch("/api/premium/competiciones").then(e=>e.ok?e.json():{victorias:0,participaciones:0,puntuacionTotal:0}).then(t)},[]),e.puntuacionTotal})()}),(0,t.jsx)("div",{className:"text-purple-100",children:"Puntuaci√≥n Total"})]})]})]}),(0,t.jsx)("div",{className:"text-center mt-8",children:(0,t.jsx)("button",{onClick:()=>e.push("/premium-nuevo"),className:"bg-white text-purple-600 px-8 py-3 rounded-lg font-bold hover:bg-purple-50 transition-colors",children:"‚Üê Volver a Premium"})})]})}):null}])}]);