(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,90597,e=>{"use strict";var o=e.i(43476),s=e.i(71645),t=e.i(56095);let r=e.i(85315).default.map(e=>({src:e.imagen,texto:e.titulo,tipo:"manual"}));var a=e.i(88379),i=e.i(18566),l=e.i(33277),n=e.i(9368);e.s(["default",0,()=>{let e;(0,i.useRouter)();let{user:c,setUser:d}=(0,l.useUser)(),[u,x]=(0,s.useState)(!1),[m,p]=(0,s.useState)(""),[h,f]=(0,s.useState)(""),[g,j]=(0,s.useState)(""),[b,y]=(0,s.useState)(""),[v,N]=(0,s.useState)(""),[w,T]=(0,s.useState)(""),[k,A]=(0,s.useState)(""),[S,C]=(0,s.useState)(1),[q,D]=(0,s.useState)(""),[P,E]=(0,s.useState)([]),[O,B]=(0,s.useState)(""),[R,L]=(0,s.useState)(""),[I,$]=(0,s.useState)([]),[F,M]=(0,s.useState)(!1),[z,U]=(0,s.useState)(""),[J,G]=(0,s.useState)(""),[Y,K]=(0,s.useState)(""),[H,W]=(0,s.useState)(""),[Q,V]=(0,s.useState)(""),[X,Z]=(0,s.useState)(""),[_,ee]=(0,s.useState)(null),[eo,es]=(0,s.useState)(null),[et,er]=(0,s.useState)({trofeosDesbloqueados:[],trofeosBloqueados:[]}),[ea,ei]=(0,s.useState)(null),[el,en]=(0,s.useState)([]),[ec,ed]=(0,s.useState)("1primaria"),[eu,ex]=(0,s.useState)("matematicas"),[em,ep]=(0,s.useState)(""),[eh,ef]=(0,s.useState)(""),[eg,ej]=(0,s.useState)([]),{t:eb}=(0,a.useTranslation)(),ey=(0,s.useMemo)(()=>O&&_||{...c,trofeosDesbloqueados:et.trofeosDesbloqueados,trofeosBloqueados:et.trofeosBloqueados},[O,_,c,et]);(0,s.useEffect)(()=>{fetch("/api/concursos").then(e=>e.json()).then(e=>{en(e)}).catch(e=>{console.warn("No se pudo cargar la lista de concursos:",e)})},[]),(0,s.useEffect)(()=>{c&&c.nick&&(fetch("/api/premium/data?nick="+c.nick).then(e=>e.json()).then(e=>{e&&!e.error?es(e):(es(null),console.warn("No hay datos premium para este usuario."))}).catch(e=>{es(null),console.warn("No se pudo cargar datos premium:",e)}),fetch("/api/user/profile?nick="+c.nick).then(e=>e.json()).then(e=>{e&&e.user&&(ei(e.user),fetch("/api/trofeos/user-trofeos?nick="+c.nick).then(e=>e.json()).then(o=>{o&&!o.error?(er(o),eq(e.user,o)):(er({trofeosDesbloqueados:[],trofeosBloqueados:[]}),eq(e.user,{trofeosDesbloqueados:[],trofeosBloqueados:[]}))}).catch(o=>{er({trofeosDesbloqueados:[],trofeosBloqueados:[]}),console.warn("No se pudo cargar trofeos:",o),eq(e.user,{trofeosDesbloqueados:[],trofeosBloqueados:[]})}))}).catch(e=>{console.warn("No se pudo cargar datos del perfil:",e)}),fetch("/api/friends?action=requests&nick="+c.nick).then(e=>e.json()).then(e=>{e.requests?ej(e.requests):ej([])}).catch(e=>{ej([]),console.warn("No se pudo cargar solicitudes:",e)}))},[c]),(0,s.useEffect)(()=>{c&&c.nick&&fetch("/api/chat?nick="+c.nick).then(e=>e.json()).then(e=>{$(e)}).catch(e=>{console.warn("No se pudo cargar los mensajes del chat:",e)})},[c]);let ev=()=>{R.trim()&&c&&fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({from:c.nick,to:ey.nick,text:R.trim()})}).then(()=>{L(""),fetch("/api/chat?nick="+c.nick).then(e=>e.json()).then(e=>$(e)).catch(e=>console.warn("No se pudo refrescar los mensajes:",e))}).catch(e=>{console.error("Error enviando mensaje:",e)})},eN=async e=>{if(c)try{(await fetch("/api/friends",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"accept",userNick:c.nick,requestId:e})})).ok?(ej(o=>o.filter(o=>o.id!==e)),window.location.reload()):alert("Error al aceptar solicitud")}catch(e){alert("Error al aceptar solicitud")}},ew=async e=>{if(c)try{(await fetch("/api/friends",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reject",userNick:c.nick,requestId:e})})).ok?(ej(o=>o.filter(o=>o.id!==e)),window.location.reload()):alert("Error al rechazar solicitud")}catch(e){alert("Error al rechazar solicitud")}},eT=async()=>{if(Q&&X)try{await fetch("/api/concursos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Q,ganador:X})}),((e,o)=>{if(!e)return;let s=P.find(o=>o.nick===e)?.likes||0;fetch("/api/users/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:e,likes:s+10})}).then(e=>e.json()).then(o=>{E(P.map(s=>s.nick===e?o:s)),c&&c.nick===e&&d(o)}).catch(e=>console.error("Error updating likes:",e))})(X,0),V(""),Z(""),fetch("/api/concursos").then(e=>e.json()).then(en)}catch(e){console.error("Error asignando ganador:",e)}},ek=async()=>{if(em.trim()&&eh.trim())try{let e=await fetch("/api/add-question",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({curso:ec,asignatura:eu,pregunta:em.trim(),respuesta:eh.trim()})});await e.json(),e.ok&&(ep(""),ef(""))}catch(e){console.error("Error al enviar pregunta:",e)}},eA=[{src:"/trofeo25.jpg",texto:"Trofeo 1",tipo:"auto"},{src:"/trofeo7.jpg",texto:"Trofeo 2",tipo:"auto"},{src:"/trofeo12.jpg",texto:"Trofeo 3",tipo:"auto"},{src:"/trofeo5.jpg",texto:"Trofeo 4",tipo:"auto"},{src:"/trofeo13.png",texto:"Trofeo 5",tipo:"auto"},{src:"/trofeo17.jpg",texto:"Trofeo 6",tipo:"auto"},{src:"/trofeo27.jpg",texto:"Trofeo 7",tipo:"auto"},{src:"/trofeo10.jpg",texto:"Trofeo 8",tipo:"auto"},{src:"/trofeo23.jpg",texto:"Trofeo 9",tipo:"auto"},{src:"/trofeo15.jpg",texto:"Trofeo 10",tipo:"auto"},{src:"/trofeo26.jpg",texto:"Trofeo 11",tipo:"auto"},{src:"/trofeo1.jpg",texto:"Trofeo 12",tipo:"auto"},{src:"/trofeo22.jpg",texto:"Trofeo 13",tipo:"auto"},{src:"/trofeo14.jpg",texto:"Trofeo 14",tipo:"auto"},{src:"/trofeo20.jpg",texto:"Trofeo 15",tipo:"auto"},{src:"/trofeo11.jpg",texto:"Trofeo 16",tipo:"auto"},{src:"/trofeo24.jpg",texto:"Trofeo 17",tipo:"auto"},{src:"/trofeo18.jpg",texto:"Trofeo 18",tipo:"auto"},{src:"/trofeo19.jpg",texto:"Trofeo 19",tipo:"auto"},{src:"/trofeo15.jpg",texto:"Trofeo 20",tipo:"auto"},{src:"/trofeo9.jpg",texto:"Trofeo 21",tipo:"auto"},{src:"/trofeo8.jpg",texto:"Trofeo 22",tipo:"auto"},{src:"/trofeo21.jpg",texto:"Trofeo 23",tipo:"auto"},{src:"/trofeo16.jpg",texto:"Trofeo 24",tipo:"auto"},{src:"/trofeo1.jpg",texto:"ðŸ† CampeÃ³n Mensual",tipo:"asignado"},{src:"/trofeo2.jpg",texto:"ðŸ¥ˆ SubcampeÃ³n Mensual",tipo:"asignado"},{src:"/trofeo3.jpg",texto:"ðŸ¥‰ Tercer Lugar Mensual",tipo:"asignado"},{src:"/trofeo4.jpg",texto:"ðŸ… Top 10 Mensual",tipo:"asignado"},{src:"/trofeo5.jpg",texto:"ðŸ“š Participante Activo",tipo:"asignado"}],eS=[{src:"/trofeo25.jpg",texto:"Trofeo 1",tipo:"auto",condicion:e=>(e.likes||0)>=10},{src:"/trofeo7.jpg",texto:"Trofeo 2",tipo:"auto",condicion:e=>Array.isArray(e.amigos)&&e.amigos.length>=1},{src:"/trofeo12.jpg",texto:"Trofeo 3",tipo:"auto",condicion:e=>(e.comentariosRecibidos||0)>=1},{src:"/trofeo5.jpg",texto:"Trofeo 4",tipo:"auto",condicion:e=>(e.historiasCreadas||0)>=1},{src:"/trofeo13.png",texto:"Trofeo 5",tipo:"auto",condicion:e=>(e.respuestasAcertadas||0)>=20},{src:"/trofeo17.jpg",texto:"Trofeo 6",tipo:"auto",condicion:e=>(e.competicionesSuperadas||0)>=1},{src:"/trofeo27.jpg",texto:"Trofeo 7",tipo:"auto",condicion:e=>(e.respuestasAcertadas||0)>=1||(e.likes||0)>=1||(e.historiasCreadas||0)>=1},{src:"/trofeo10.jpg",texto:"Trofeo 8",tipo:"auto",condicion:e=>(e.concursosGanados||0)>=1},{src:"/trofeo23.jpg",texto:"Trofeo 9",tipo:"auto",condicion:e=>(e.likes||0)>=100},{src:"/trofeo15.jpg",texto:"Trofeo 10",tipo:"auto",condicion:e=>Array.isArray(e.amigos)&&e.amigos.length>=10},{src:"/trofeo26.jpg",texto:"Trofeo 11",tipo:"auto",condicion:e=>(e.historiasCreadas||0)>=3},{src:"/trofeo1.jpg",texto:"Trofeo 12",tipo:"auto",condicion:e=>(e.comentariosRecibidos||0)>=3},{src:"/trofeo22.jpg",texto:"Trofeo 13",tipo:"auto",condicion:e=>(e.competicionesSuperadas||0)>=1},{src:"/trofeo14.jpg",texto:"Trofeo 14",tipo:"auto",condicion:e=>(e.likes||0)>=500},{src:"/trofeo20.jpg",texto:"Trofeo 15",tipo:"auto",condicion:e=>Array.isArray(e.amigos)&&e.amigos.length>=30},{src:"/trofeo11.jpg",texto:"Trofeo 16",tipo:"auto",condicion:e=>(e.comentariosRecibidos||0)>=10},{src:"/trofeo24.jpg",texto:"Trofeo 17",tipo:"auto",condicion:e=>(e.historiasCreadas||0)>=15},{src:"/trofeo18.jpg",texto:"Trofeo 18",tipo:"auto",condicion:e=>(e.concursosGanados||0)>=3},{src:"/trofeo19.jpg",texto:"Trofeo 19",tipo:"auto",condicion:e=>(e.respuestasAcertadas||0)>=1e3},{src:"/trofeo15.jpg",texto:"Trofeo 20",tipo:"auto",condicion:e=>(e.anosEnStoryUp||0)>=1},{src:"/trofeo9.jpg",texto:"Trofeo 21",tipo:"auto",condicion:e=>(e.historiasCreadas||0)>=30},{src:"/trofeo8.jpg",texto:"Trofeo 22",tipo:"auto",condicion:e=>(e.likes||0)>=1e3},{src:"/trofeo21.jpg",texto:"Trofeo 23",tipo:"auto",condicion:e=>Array.isArray(e.amigos)&&e.amigos.length>=50},{src:"/trofeo16.jpg",texto:"Trofeo 24",tipo:"auto",condicion:e=>(e.likes||0)>=500&&Array.isArray(e.amigos)&&e.amigos.length>=10&&(e.historiasCreadas||0)>=5&&(e.respuestasAcertadas||0)>=100}];[...eA,...r];let eC=e=>{let o={...e,amigos:Array.isArray(e.amigos)?e.amigos:[]};console.log("getAutoTrofeos: Evaluating user data:",o);let s=eS.map((e,s)=>{let t="function"==typeof e.condicion&&e.condicion(o);return console.log(`getAutoTrofeos: Trofeo ${s} condition result:`,t,"for user data:",{likes:o.likes,amigos:o.amigos,comentariosRecibidos:o.comentariosRecibidos,historias:o.historias,respuestasAcertadas:o.respuestasAcertadas}),t?s+1:null}).filter(e=>null!==e);console.log("getAutoTrofeos: Final auto trofeos:",s);let t=!0===o.premium||!0===o.isPremium||"premium"===o.tipo,r=Array.isArray(o.historias)?o.historias.length:o.historiasCreadas||0,a=o.respuestasAcertadas||0;t&&r>=35&&s.push(101),t&&a>=1200&&s.push(102);let i=Array.isArray(o.amigos)?o.amigos.length:0;t&&i>=60&&s.push(103);let l=!1;t&&Array.isArray(o.historias)&&(l=o.historias.some(e=>{if(!e||!e.titulo||!e.fecha||!e.modo)return!1;let o=e.titulo.toLowerCase(),s=o.includes("navidad")||o.includes("navideÃ±o")||o.includes("navideÃ±a"),t=new Date(e.fecha),r=t.getFullYear(),a=new Date(r,11,20),i=new Date(r+1,0,6,23,59,59);return"My Live"===e.modo&&s&&t>=a&&t<=i})),t&&l&&s.push(104);let n=!1;t&&Array.isArray(o.historias)&&(n=o.historias.some(e=>{if(!e||!e.fecha||!e.modo)return!1;let o=new Date(e.fecha),s=o.getFullYear(),t=new Date(s,5,15),r=new Date(s,8,15,23,59,59);return"My Live"===e.modo&&o>=t&&o<=r})),t&&n&&s.push(105);let c=0;if(o.premiumInicio&&o.premiumExpiracion){let e=new Date(o.premiumInicio),s=new Date(o.premiumExpiracion);c=(s.getFullYear()-e.getFullYear())*12+(s.getMonth()-e.getMonth()),s.getDate()<e.getDate()&&c--}t&&c>=6&&s.push(106);let d=!1;t&&Array.isArray(o.historias)&&(d=o.historias.some(e=>!!e&&!!e.titulo&&!!e.imagen&&e.titulo.toLowerCase().includes("logo storyup")&&!!e.imagen)),t&&d&&s.push(107),t&&r>=50&&s.push(108);let u=Array.isArray(o.trofeosDesbloqueados)?o.trofeosDesbloqueados.length:0,x=s.length;t&&u+x>=30&&s.push(109),t&&a>=2500&&s.push(110);let m=o.nivelesMaterias||{},p=["matematicas","lenguaje","ciencias","ingles","historia","geografia","literatura"].every(e=>m[e]>=3);return t&&p&&s.push(111),t&&i>=100&&s.push(112),s},eq=async(e,o)=>{if(!e||!e.nick)return void console.log("syncAutoTrofeos: No userData or nick",e);console.log("syncAutoTrofeos: Starting for user",e.nick,"with data:",e),console.log("syncAutoTrofeos: Checking conditions manually:"),console.log("- amigos:",e.amigos,">= 1?",e.amigos>=1),console.log("- likes:",e.likes,">= 10?",e.likes>=10),console.log("- historias:",e.historias,">= 1?",e.historias>=1),console.log("- respuestasAcertadas:",e.respuestasAcertadas,">= 20?",e.respuestasAcertadas>=20),console.log("- comentariosRecibidos:",e.comentariosRecibidos,">= 1?",e.comentariosRecibidos>=1);try{let s=eC(e);console.log("syncAutoTrofeos: Auto trofeos calculated:",s);let t=Array.isArray(o.trofeosDesbloqueados)?o.trofeosDesbloqueados:[],r=Array.isArray(o.trofeosBloqueados)?o.trofeosBloqueados:[];console.log("syncAutoTrofeos: Current trofeos - manual:",t,"bloqueados:",r);let a=s.filter(e=>!t.includes(e)&&!r.includes(e)),i=t.filter(e=>!s.includes(e));console.log("syncAutoTrofeos: Trofeos to remove:",i);if(a.length>0||i.length>0){let o={trofeosDesbloqueados:[...t,...a].filter(e=>!i.includes(e)),trofeosBloqueados:r};console.log("syncAutoTrofeos: Saving updated trofeos:",o),await fetch("/api/trofeos/user-trofeos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nick:e.nick,...o})}),er(o),console.log(`Sincronizados ${a.length} trofeos autom\xe1ticos y removidos ${i.length} trofeos para ${e.nick}`)}else console.log("syncAutoTrofeos: No changes needed")}catch(e){console.error("Error sincronizando trofeos automÃ¡ticos:",e)}},eD=(e,o)=>{console.log("isTrofeoUnlocked called with user:",e,"idx:",o),console.log("displayedUser:",ey),console.log("userTrofeos:",et);let s=eC(e);console.log("Auto trofeos for this user:",s);let t=Array.isArray(et.trofeosDesbloqueados)?et.trofeosDesbloqueados:[],r=Array.isArray(et.trofeosBloqueados)?et.trofeosBloqueados:[];console.log("Manual trofeos:",t,"Bloqueados:",r);let a=o<eA.length?o+1:101+(o-eA.length),i=(s.includes(a)||t.includes(a))&&!r.includes(a);return console.log("Trofeo",o,"id:",a,"is unlocked:",i),i};if(!c)return(0,o.jsx)("div",{className:"min-h-screen bg-green-100 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"max-w-md w-full bg-white shadow rounded p-6 text-center",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Perfil"}),(0,o.jsx)("p",{className:"text-gray-600",children:"No se ha iniciado sesiÃ³n."})]})});let eP=!!ey&&(!0===ey.premium||!0===ey.isPremium||"premium"===ey.tipo);return(0,o.jsxs)("div",{className:"min-h-screen bg-green-100 flex flex-col pt-4",children:[eg.length>0&&(0,o.jsx)("div",{className:"w-full max-w-4xl mx-auto mb-4",children:(0,o.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[(0,o.jsx)("h3",{className:"text-lg font-bold text-yellow-800 mb-2",children:"Solicitudes de Amistad Pendientes"}),eg.map(e=>(0,o.jsxs)("div",{className:"flex items-center justify-between bg-white p-3 rounded mb-2 shadow",children:[(0,o.jsxs)("span",{className:"text-gray-700",children:["Solicitud de ",(0,o.jsx)("strong",{children:(0,t.renderNick)(e.solicitante.nick)})]}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("button",{onClick:()=>eN(e.id),className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded font-semibold",children:"Aceptar"}),(0,o.jsx)("button",{onClick:()=>ew(e.id),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded font-semibold",children:"Rechazar"})]})]},e.id))]})}),(0,o.jsx)("div",{className:"w-full max-w-6xl mx-auto mt-4 mb-4",children:(0,o.jsxs)("h1",{className:"text-3xl font-bold text-center",children:["Perfil de: ",(0,o.jsx)(n.UserLink,{nick:ey.nick})]})}),(0,o.jsxs)("div",{className:"w-full max-w-6xl mx-auto mt-8 grid grid-cols-2 gap-8",children:[(0,o.jsxs)("div",{className:`bg-white rounded-lg shadow-md p-6 flex flex-col items-center relative transition-all duration-500 ${eP?"border-4 border-yellow-400 shadow-2xl shadow-yellow-400/50 animate-pulse overflow-hidden":""}`,children:[eP&&(0,o.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,o.jsx)("div",{className:"absolute top-2 right-2 w-2 h-2 bg-yellow-400 rounded-full animate-ping opacity-75"}),(0,o.jsx)("div",{className:"absolute top-4 left-4 w-1 h-1 bg-yellow-300 rounded-full animate-bounce opacity-60"}),(0,o.jsx)("div",{className:"absolute bottom-4 right-6 w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse opacity-80"})]}),(0,o.jsx)("div",{className:"flex justify-between items-center mb-4 relative",children:(0,o.jsxs)("h3",{className:`text-xl font-bold text-center w-full transition-all duration-300 ${eP?"text-yellow-600":""}`,children:["InformaciÃ³n Personal",eP&&(0,o.jsx)("span",{className:"ml-2 animate-spin",children:"ðŸ‘‘"})]})}),(0,o.jsxs)("div",{className:"flex flex-col items-center mb-4 relative",children:[(0,o.jsxs)("div",{className:"relative ",children:[(0,o.jsx)("img",{src:ey.avatar||"/avatars/simple1.png",alt:"Avatar",className:`w-20 h-20 rounded-full mb-2 transition-all duration-300 ${eP?"ring-4 ring-yellow-400 ring-opacity-70 shadow-lg shadow-yellow-400/50 hover:scale-110":""}`}),eP&&(0,o.jsx)("div",{className:"absolute -top-1 -right-1 w-6 h-6 bg-gradient-to-r from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center text-xs animate-bounce",children:"âœ¨"})]}),(0,o.jsx)("div",{className:"mt-4",children:(0,o.jsx)("a",{href:"/perfil/avatar",className:"bg-blue-500 text-white px-4 py-2 rounded font-semibold hover:bg-blue-600 transition",children:"Seleccionar y Cambiar Avatar"})})]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Nick:"})," ",(0,t.renderNick)(ey.nick)]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Email:"})," ",ey.email]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Centro Educativo:"})," ",ey.centro]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Curso:"})," ",ey.curso]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Tipo de Usuario:"})," ",ey.tipo]}),(0,o.jsxs)("p",{children:[(0,o.jsx)("strong",{children:"Fecha de InscripciÃ³n:"})," ",ey.fechaInscripcion?new Date(ey.fechaInscripcion).toLocaleDateString("es-ES"):""]}),(0,o.jsx)("div",{className:"mb-2 flex items-center",children:(0,o.jsxs)("div",{className:"flex flex-col mt-2 gap-y-4",children:[(0,o.jsxs)("div",{className:"flex flex-row gap-x-12",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ‘"}),(0,o.jsx)("strong",{children:"Likes:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-green-300 text-green-900 font-bold text-sm",children:ey.likes||0})]}),(0,o.jsxs)("div",{className:"flex items-center ml-8",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ‘¥"}),(0,o.jsx)("strong",{children:"Total de Amigos:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-blue-300 text-blue-900 font-bold text-sm",children:ey.amigos||0})]})]}),(0,o.jsxs)("div",{className:"flex flex-row gap-x-12",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ“–"}),(0,o.jsx)("strong",{children:"Total de Historias:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-purple-200 text-purple-900 font-bold text-sm",children:ey.historias?ey.historias.length:0})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ’¬"}),(0,o.jsx)("strong",{children:"Total de Comentarios:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-yellow-200 text-yellow-900 font-bold text-sm",children:ey.comentariosRecibidos||0})]})]}),(0,o.jsxs)("div",{className:"flex flex-row gap-x-12",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ†"}),(0,o.jsx)("strong",{children:"Trofeos Desbloqueados:"}),(e=(Array.isArray(ey.trofeosDesbloqueados)?ey.trofeosDesbloqueados:[]).length,(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-pink-200 text-pink-900 font-bold text-sm",children:e}))]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"âœ…"}),(0,o.jsx)("strong",{children:"Respuestas acertadas:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-indigo-200 text-indigo-900 font-bold text-sm",children:ey.respuestasAcertadas||0})]})]}),(0,o.jsxs)("div",{className:"flex flex-row gap-x-12",children:[(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸ¥‡"}),(0,o.jsx)("strong",{children:"Competiciones:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-teal-200 text-teal-900 font-bold text-sm",children:ey.competicionesSuperadas||0})]}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)("span",{className:"mr-2 text-lg",children:"ðŸŽ‰"}),(0,o.jsx)("strong",{children:"Concursos:"}),(0,o.jsx)("span",{className:"ml-2 inline-flex items-center justify-center w-8 h-8 rounded-full bg-red-200 text-red-900 font-bold text-sm",children:ey.concursosGanados||0})]})]})]})})]}),(0,o.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-4",children:"Trofeos"}),(0,o.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-8 gap-4",children:eA.slice(0,24).map((e,s)=>(0,o.jsxs)("div",{className:`relative aspect-square flex flex-col items-center justify-center p-1 rounded-lg overflow-hidden ${eD(ey,s)?"bg-yellow-100 border-2 border-yellow-400":"bg-gray-100 border-2 border-gray-300"}`,children:[(0,o.jsx)("img",{src:e.src,alt:e.texto,className:`w-[50px] h-[50px] ${!eD(ey,s)?"opacity-25":""}`}),!eD(ey,s)&&(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-red-600 text-4xl font-bold",children:"âœ•"})})]},s))})]}),(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-4",children:"Trofeos Premium"}),(0,o.jsx)("div",{className:"grid grid-cols-4 md:grid-cols-6 gap-4",children:r.map((e,s)=>(0,o.jsxs)("div",{className:`relative aspect-square flex flex-col items-center justify-center p-1 rounded-lg overflow-hidden ${eD(ey,eA.length+s)?"bg-purple-100 border-2 border-purple-400":"bg-gray-100 border-2 border-gray-300"}`,children:[(0,o.jsx)("img",{src:e.src,alt:e.texto,className:`w-[50px] h-[50px] ${!eD(ey,eA.length+s)?"opacity-25":""}`}),!eD(ey,eA.length+s)&&(0,o.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,o.jsx)("span",{className:"text-red-600 text-4xl font-bold",children:"âœ•"})})]},s))})]})]})]}),(0,o.jsx)("div",{className:"w-full max-w-6xl mx-auto mt-8",children:(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 flex flex-row gap-6",children:[(0,o.jsxs)("div",{className:"w-1/4 min-w-[180px] flex flex-col gap-2",children:[(0,o.jsx)("label",{htmlFor:"user-selector",className:"font-semibold mb-2",children:"Selecciona usuario:"}),(0,o.jsxs)("select",{id:"user-selector",className:"border rounded px-3 py-2",value:O,onChange:e=>B(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"-- Elige un usuario --"}),P.filter(e=>e.nick!==c.nick).map(e=>(0,o.jsx)("option",{value:e.nick,children:e.nick},e.nick))]})]}),(0,o.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-4",children:"Chat"}),(0,o.jsx)("div",{className:"h-64 overflow-y-auto border rounded p-4 mb-4 bg-gray-50",children:I.map((e,s)=>(0,o.jsxs)("div",{className:`mb-2 ${e.from===c.nick?"text-right":"text-left"}`,children:[(0,o.jsxs)("span",{className:"font-semibold",children:[e.from,":"]})," ",e.text,e.fecha&&(0,o.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(",new Date(e.fecha).toLocaleString(),")"]})]},s))}),(0,o.jsxs)("div",{className:"flex gap-2",children:[(0,o.jsx)("input",{type:"text",value:R,onChange:e=>L(e.target.value),placeholder:"Escribe un mensaje...",className:"flex-1 border rounded px-3 py-2",onKeyPress:e=>"Enter"===e.key&&ev(),disabled:!O}),(0,o.jsx)("button",{onClick:ev,className:"bg-blue-500 text-white px-4 py-2 rounded font-semibold",disabled:!O||!R.trim(),children:"Enviar"})]})]})]})}),c.tipo&&"docente"===c.tipo.toLowerCase()&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"w-full max-w-6xl mx-auto mt-20",children:[(0,o.jsxs)("div",{className:"grid grid-cols-2 gap-12",children:[(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-2",children:"Crear noticia"}),(0,o.jsxs)("form",{className:"w-full flex flex-col gap-4",onSubmit:e=>{e.preventDefault(),fetch("/api/noticias",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({titulo:z,contenido:J,autorNick:c?c.nick:""})}).then(e=>e.json()).then(()=>{U(""),G(""),K("")}).catch(e=>{console.error("Error creando noticia:",e)})},children:[(0,o.jsx)("input",{type:"text",className:"border rounded px-3 py-2 w-full",placeholder:"TÃ­tulo de la noticia",value:z,onChange:e=>U(e.target.value)}),(0,o.jsxs)("div",{className:"relative w-full",children:[(0,o.jsx)("textarea",{className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:"Escribe la noticia aquÃ­...",value:J,onChange:e=>G(e.target.value)}),Y&&(0,o.jsx)("img",{src:Y,alt:"PrevisualizaciÃ³n",className:"absolute left-0 top-0 w-full h-full object-contain rounded shadow pointer-events-none",style:{zIndex:1,opacity:.7}})]}),(0,o.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,o.jsx)("input",{id:"noticia-imagen",type:"file",accept:"image/*",className:"hidden",onChange:e=>{let o=e.target.files?.[0];if(o){D(o.name);let e=new FileReader;e.onload=e=>{K(e.target?.result)},e.readAsDataURL(o)}else D(""),K("")}}),(0,o.jsx)("button",{type:"button",className:"bg-gray-200 text-gray-700 px-4 py-2 rounded font-semibold border",onClick:()=>document.getElementById("noticia-imagen")?.click(),children:"Seleccionar imagen"}),(0,o.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded font-semibold",children:"Publicar noticia"})]})]})]}),(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-2",children:"Crear concurso"}),(0,o.jsxs)("form",{className:"w-full flex flex-col gap-4",onSubmit:e=>{e.preventDefault(),fetch("/api/concursos",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({numero:S,titulo:g,texto:b,inicio:v,fin:w,autor:c?c.nick:"",ganador:k,fechaFinal:w})}).then(e=>e.json()).then(()=>{C(S+1),j(""),y(""),N(""),T(""),A(""),fetch("/api/concursos").then(e=>e.json()).then(en)}).catch(e=>{console.error("Error creando concurso:",e)})},children:[(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)("input",{type:"text",className:"border rounded px-3 py-2 flex-1",placeholder:eb("titulo"),value:g,onChange:e=>j(e.target.value)}),(0,o.jsxs)("span",{className:"text-sm text-gray-500",children:["ID: ",S]})]}),(0,o.jsx)("textarea",{className:"border rounded px-3 py-2 w-full min-h-[80px]",placeholder:eb("descripcion"),value:b,onChange:e=>y(e.target.value)}),(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,o.jsx)("label",{className:"text-sm mb-1",children:eb("fechaInicio")}),(0,o.jsx)("input",{type:"date",className:"border rounded px-3 py-2",value:v,onChange:e=>N(e.target.value)})]}),(0,o.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,o.jsx)("label",{className:"text-sm mb-1",children:eb("fechaFin")}),(0,o.jsx)("input",{type:"date",className:"border rounded px-3 py-2",value:w,onChange:e=>T(e.target.value)})]}),(0,o.jsx)("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded font-semibold",children:eb("enviar")})]})]})]})]}),(0,o.jsxs)("div",{className:"w-full mt-6 pt-4 border-t border-gray-200",children:[(0,o.jsx)("h4",{className:"text-lg font-semibold text-center mb-3 text-gray-700",children:eb("gestionarConcursosFinalizados")}),(0,o.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,o.jsxs)("select",{className:"border rounded px-3 py-2 text-sm",value:Q,onChange:e=>V(e.target.value),children:[(0,o.jsx)("option",{value:"",children:eb("seleccionarConcurso")}),el.filter(e=>!!e.fin&&new Date(e.fin)<new Date&&e.autor===c.nick&&!e.ganador).map(e=>(0,o.jsxs)("option",{value:e.id,children:[e.titulo," (ID: ",e.numero,") - Sin ganador"]},e.id))]}),(0,o.jsxs)("select",{className:"border rounded px-3 py-2 text-sm",value:X,onChange:e=>Z(e.target.value),children:[(0,o.jsx)("option",{value:"",children:eb("seleccionarGanador")}),P.sort((e,o)=>e.nick.localeCompare(o.nick)).map((e,s)=>(0,o.jsx)("option",{value:e.nick,children:e.nick},s))]}),(0,o.jsx)("button",{className:"bg-green-500 text-white px-4 py-2 rounded font-semibold text-sm",onClick:eT,disabled:!Q||!X,children:eb("asignarGanador")})]})]}),(0,o.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 flex flex-col gap-4 mt-6",children:[(0,o.jsx)("h3",{className:"text-xl font-bold text-center mb-2",children:"Agregar Pregunta - Aprende con Pipo"}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Curso:"}),(0,o.jsxs)("select",{value:ec,onChange:e=>ed(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,o.jsx)("option",{value:"1primaria",children:"1Âº Primaria"}),(0,o.jsx)("option",{value:"2primaria",children:"2Âº Primaria"}),(0,o.jsx)("option",{value:"3primaria",children:"3Âº Primaria"}),(0,o.jsx)("option",{value:"4primaria",children:"4Âº Primaria"}),(0,o.jsx)("option",{value:"5primaria",children:"5Âº Primaria"}),(0,o.jsx)("option",{value:"6primaria",children:"6Âº Primaria"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Asignatura:"}),(0,o.jsxs)("select",{value:eu,onChange:e=>ex(e.target.value),className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,o.jsx)("option",{value:"campeonato",children:"Campeonato"}),(0,o.jsx)("option",{value:"general",children:"General"}),(0,o.jsx)("option",{value:"matematicas",children:"MatemÃ¡ticas"}),(0,o.jsx)("option",{value:"lenguaje",children:"Lenguaje"}),(0,o.jsx)("option",{value:"literatura",children:"Literatura"}),(0,o.jsx)("option",{value:"historia",children:"Historia"}),(0,o.jsx)("option",{value:"geografia",children:"GeografÃ­a"}),(0,o.jsx)("option",{value:"ingles",children:"InglÃ©s"}),(0,o.jsx)("option",{value:"naturaleza",children:"Naturaleza"})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Pregunta:"}),(0,o.jsx)("textarea",{value:em,onChange:e=>ep(e.target.value),placeholder:"Escribe la pregunta aquÃ­...",className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 h-20 resize-none"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-blue-700 mb-2",children:"Respuesta:"}),(0,o.jsx)("input",{type:"text",value:eh,onChange:e=>ef(e.target.value),placeholder:"Escribe la respuesta aquÃ­...",className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,o.jsx)("div",{className:"text-center",children:(0,o.jsx)("button",{onClick:ek,className:"bg-gradient-to-r from-green-500 to-green-600 text-white px-8 py-3 rounded-lg font-bold hover:shadow-lg transform hover:scale-105 transition-all",children:"âœ… Enviar Pregunta"})}),(0,o.jsx)("div",{className:"mt-4 p-3 bg-blue-100 border border-blue-300 rounded",children:(0,o.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,o.jsx)("strong",{children:"ðŸ’¡ InformaciÃ³n:"})," Las preguntas se agregan automÃ¡ticamente al archivo correspondiente",(0,o.jsxs)("code",{className:"bg-blue-200 px-1 rounded",children:[eu,"-",ec,".json"]})]})})]})]}),c.tipo&&"docente"===c.tipo.toLowerCase()&&(0,o.jsx)("div",{className:"w-full max-w-6xl mx-auto mt-16 bg-white shadow-lg rounded-lg p-6 flex flex-col items-center",children:(0,o.jsxs)("div",{className:"w-full",children:[(0,o.jsx)("h3",{className:"text-xl font-bold mb-4 text-center",children:eb("panelAdministracion")}),(0,o.jsx)("form",{className:"w-full flex flex-col items-center gap-4",onSubmit:e=>{e.preventDefault(),f("")},children:(0,o.jsxs)("div",{className:"flex w-full max-w-xs items-center gap-2",children:[(0,o.jsx)("input",{type:"text",className:"border rounded px-3 py-2 min-w-[280px] max-w-full",placeholder:eb("palabraProhibida"),value:h,onChange:e=>f(e.target.value)}),(0,o.jsx)("button",{type:"submit",className:"bg-red-500 text-white px-4 py-2 rounded font-semibold whitespace-nowrap",children:"Seleccionar"})]})}),(0,o.jsx)("h4",{className:"text-lg font-semibold mt-6 text-center",children:eb("sistemaAntibullying")}),(0,o.jsx)("div",{className:"mt-4 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md text-gray-700 max-w-2xl mx-auto",children:(0,o.jsxs)("div",{className:"flex flex-row items-start gap-8",children:[(0,o.jsxs)("div",{className:"flex-1",children:[(0,o.jsx)("p",{className:"font-semibold mb-2",children:eb("avisoAntibullying")}),(0,o.jsxs)("ol",{className:"list-decimal ml-6 space-y-1",children:[(0,o.jsx)("li",{children:eb("historiasTerror")}),(0,o.jsx)("li",{children:eb("perdidaLikes")}),(0,o.jsx)("li",{children:eb("mensajesUsuario")}),(0,o.jsx)("li",{children:eb("palabrasProhibidasChat")}),(0,o.jsx)("li",{children:eb("actividadConsecutiva")})]})]}),(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center min-w-[180px]",children:[(0,o.jsxs)("button",{type:"button",className:`relative w-32 h-32 rounded-full font-bold text-white text-lg mb-2 transition-all flex items-center justify-center ${u?"bg-red-600 opacity-100 shadow-lg animate-blink":"bg-green-600 opacity-40"}`,disabled:!u,onClick:()=>{x(!1),p("")},children:[u?"Aviso Antibullying":eb("sinPeligro"),(0,o.jsx)("span",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(0,o.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 100 100",className:"opacity-70",children:[(0,o.jsx)("line",{x1:"10",y1:"10",x2:"90",y2:"90",stroke:"white",strokeWidth:"10"}),(0,o.jsx)("line",{x1:"90",y1:"10",x2:"10",y2:"90",stroke:"white",strokeWidth:"10"})]})})]}),m&&(0,o.jsx)("div",{className:"text-center text-red-700 font-semibold text-base",children:m})]})]})})]})})]})]})}],90597)}]);